{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { attr, DOM, Observable, observable } from \"@microsoft/fast-element\";\nimport { limit, uniqueId } from \"@microsoft/fast-web-utilities\";\nimport { DelegatesARIAListbox } from \"../listbox/listbox.js\";\nimport { StartEnd } from \"../patterns/start-end.js\";\nimport { SelectPosition } from \"../select/select.options.js\";\nimport { applyMixins } from \"../utilities/apply-mixins.js\";\nimport { FormAssociatedCombobox } from \"./combobox.form-associated.js\";\nimport { ComboboxAutocomplete } from \"./combobox.options.js\";\n/**\n * A Combobox Custom HTML Element.\n * Implements the {@link https://w3c.github.io/aria-practices/#combobox | ARIA combobox }.\n *\n * @slot start - Content which can be provided before the input\n * @slot end - Content which can be provided after the input\n * @slot control - Used to replace the input element representing the combobox\n * @slot indicator - The visual indicator representing the expanded state\n * @slot - The default slot for the options\n * @csspart control - The wrapper element containing the input area, including start and end\n * @csspart selected-value - The input element representing the selected value\n * @csspart indicator - The element wrapping the indicator slot\n * @csspart listbox - The wrapper for the listbox slotted options\n * @fires change - Fires a custom 'change' event when the value updates\n *\n * @public\n */\n\nexport class Combobox extends FormAssociatedCombobox {\n  constructor() {\n    super(...arguments);\n    /**\n     * The internal value property.\n     *\n     * @internal\n     */\n\n    this._value = \"\";\n    /**\n     * The collection of currently filtered options.\n     *\n     * @public\n     */\n\n    this.filteredOptions = [];\n    /**\n     * The current filter value.\n     *\n     * @internal\n     */\n\n    this.filter = \"\";\n    /**\n     * The initial state of the position attribute.\n     *\n     * @internal\n     */\n\n    this.forcedPosition = false;\n    /**\n     * The unique id for the internal listbox element.\n     *\n     * @internal\n     */\n\n    this.listboxId = uniqueId(\"listbox-\");\n    /**\n     * The max height for the listbox when opened.\n     *\n     * @internal\n     */\n\n    this.maxHeight = 0;\n    /**\n     * The open attribute.\n     *\n     * @public\n     * @remarks\n     * HTML Attribute: open\n     */\n\n    this.open = false;\n  }\n  /**\n   * Reset the element to its first selectable option when its parent form is reset.\n   *\n   * @internal\n   */\n\n\n  formResetCallback() {\n    super.formResetCallback();\n    this.setDefaultSelectedOption();\n    this.updateValue();\n  }\n  /** {@inheritDoc (FormAssociated:interface).validate} */\n\n\n  validate() {\n    super.validate(this.control);\n  }\n\n  get isAutocompleteInline() {\n    return this.autocomplete === ComboboxAutocomplete.inline || this.isAutocompleteBoth;\n  }\n\n  get isAutocompleteList() {\n    return this.autocomplete === ComboboxAutocomplete.list || this.isAutocompleteBoth;\n  }\n\n  get isAutocompleteBoth() {\n    return this.autocomplete === ComboboxAutocomplete.both;\n  }\n  /**\n   * Sets focus and synchronize ARIA attributes when the open property changes.\n   *\n   * @param prev - the previous open value\n   * @param next - the current open value\n   *\n   * @internal\n   */\n\n\n  openChanged() {\n    if (this.open) {\n      this.ariaControls = this.listboxId;\n      this.ariaExpanded = \"true\";\n      this.setPositioning();\n      this.focusAndScrollOptionIntoView(); // focus is directed to the element when `open` is changed programmatically\n\n      DOM.queueUpdate(() => this.focus());\n      return;\n    }\n\n    this.ariaControls = \"\";\n    this.ariaExpanded = \"false\";\n  }\n  /**\n   * The list of options.\n   *\n   * @public\n   * @remarks\n   * Overrides `Listbox.options`.\n   */\n\n\n  get options() {\n    Observable.track(this, \"options\");\n    return this.filteredOptions.length ? this.filteredOptions : this._options;\n  }\n\n  set options(value) {\n    this._options = value;\n    Observable.notify(this, \"options\");\n  }\n  /**\n   * Updates the placeholder on the proxy element.\n   * @internal\n   */\n\n\n  placeholderChanged() {\n    if (this.proxy instanceof HTMLInputElement) {\n      this.proxy.placeholder = this.placeholder;\n    }\n  }\n\n  positionChanged(prev, next) {\n    this.positionAttribute = next;\n    this.setPositioning();\n  }\n  /**\n   * The value property.\n   *\n   * @public\n   */\n\n\n  get value() {\n    Observable.track(this, \"value\");\n    return this._value;\n  }\n\n  set value(next) {\n    var _a, _b, _c;\n\n    const prev = `${this._value}`;\n\n    if (this.$fastController.isConnected && this.options) {\n      const selectedIndex = this.options.findIndex(el => el.text.toLowerCase() === next.toLowerCase());\n      const prevSelectedValue = (_a = this.options[this.selectedIndex]) === null || _a === void 0 ? void 0 : _a.text;\n      const nextSelectedValue = (_b = this.options[selectedIndex]) === null || _b === void 0 ? void 0 : _b.text;\n      this.selectedIndex = prevSelectedValue !== nextSelectedValue ? selectedIndex : this.selectedIndex;\n      next = ((_c = this.firstSelectedOption) === null || _c === void 0 ? void 0 : _c.text) || next;\n    }\n\n    if (prev !== next) {\n      this._value = next;\n      super.valueChanged(prev, next);\n      Observable.notify(this, \"value\");\n    }\n  }\n  /**\n   * Handle opening and closing the listbox when the combobox is clicked.\n   *\n   * @param e - the mouse event\n   * @internal\n   */\n\n\n  clickHandler(e) {\n    if (this.disabled) {\n      return;\n    }\n\n    if (this.open) {\n      const captured = e.target.closest(`option,[role=option]`);\n\n      if (!captured || captured.disabled) {\n        return;\n      }\n\n      this.selectedOptions = [captured];\n      this.control.value = captured.text;\n      this.clearSelectionRange();\n      this.updateValue(true);\n    }\n\n    this.open = !this.open;\n\n    if (this.open) {\n      this.control.focus();\n    }\n\n    return true;\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.forcedPosition = !!this.positionAttribute;\n\n    if (this.value) {\n      this.initialValue = this.value;\n    }\n  }\n  /**\n   * Synchronize the `aria-disabled` property when the `disabled` property changes.\n   *\n   * @param prev - The previous disabled value\n   * @param next - The next disabled value\n   *\n   * @internal\n   */\n\n\n  disabledChanged(prev, next) {\n    if (super.disabledChanged) {\n      super.disabledChanged(prev, next);\n    }\n\n    this.ariaDisabled = this.disabled ? \"true\" : \"false\";\n  }\n  /**\n   * Filter available options by text value.\n   *\n   * @public\n   */\n\n\n  filterOptions() {\n    if (!this.autocomplete || this.autocomplete === ComboboxAutocomplete.none) {\n      this.filter = \"\";\n    }\n\n    const filter = this.filter.toLowerCase();\n    this.filteredOptions = this._options.filter(o => o.text.toLowerCase().startsWith(this.filter.toLowerCase()));\n\n    if (this.isAutocompleteList) {\n      if (!this.filteredOptions.length && !filter) {\n        this.filteredOptions = this._options;\n      }\n\n      this._options.forEach(o => {\n        o.hidden = !this.filteredOptions.includes(o);\n      });\n    }\n  }\n  /**\n   * Focus the control and scroll the first selected option into view.\n   *\n   * @internal\n   * @remarks\n   * Overrides: `Listbox.focusAndScrollOptionIntoView`\n   */\n\n\n  focusAndScrollOptionIntoView() {\n    if (this.contains(document.activeElement)) {\n      this.control.focus();\n\n      if (this.firstSelectedOption) {\n        requestAnimationFrame(() => {\n          var _a;\n\n          (_a = this.firstSelectedOption) === null || _a === void 0 ? void 0 : _a.scrollIntoView({\n            block: \"nearest\"\n          });\n        });\n      }\n    }\n  }\n  /**\n   * Handle focus state when the element or its children lose focus.\n   *\n   * @param e - The focus event\n   * @internal\n   */\n\n\n  focusoutHandler(e) {\n    this.syncValue();\n\n    if (!this.open) {\n      return true;\n    }\n\n    const focusTarget = e.relatedTarget;\n\n    if (this.isSameNode(focusTarget)) {\n      this.focus();\n      return;\n    }\n\n    if (!this.options || !this.options.includes(focusTarget)) {\n      this.open = false;\n    }\n  }\n  /**\n   * Handle content changes on the control input.\n   *\n   * @param e - the input event\n   * @internal\n   */\n\n\n  inputHandler(e) {\n    this.filter = this.control.value;\n    this.filterOptions();\n\n    if (!this.isAutocompleteInline) {\n      this.selectedIndex = this.options.map(option => option.text).indexOf(this.control.value);\n    }\n\n    if (e.inputType.includes(\"deleteContent\") || !this.filter.length) {\n      return true;\n    }\n\n    if (this.isAutocompleteList && !this.open) {\n      this.open = true;\n    }\n\n    if (this.isAutocompleteInline) {\n      if (this.filteredOptions.length) {\n        this.selectedOptions = [this.filteredOptions[0]];\n        this.selectedIndex = this.options.indexOf(this.firstSelectedOption);\n        this.setInlineSelection();\n      } else {\n        this.selectedIndex = -1;\n      }\n    }\n\n    return;\n  }\n  /**\n   * Handle keydown actions for listbox navigation.\n   *\n   * @param e - the keyboard event\n   * @internal\n   */\n\n\n  keydownHandler(e) {\n    const key = e.key;\n\n    if (e.ctrlKey || e.shiftKey) {\n      return true;\n    }\n\n    switch (key) {\n      case \"Enter\":\n        {\n          this.syncValue();\n\n          if (this.isAutocompleteInline) {\n            this.filter = this.value;\n          }\n\n          this.open = false;\n          this.clearSelectionRange();\n          break;\n        }\n\n      case \"Escape\":\n        {\n          if (!this.isAutocompleteInline) {\n            this.selectedIndex = -1;\n          }\n\n          if (this.open) {\n            this.open = false;\n            break;\n          }\n\n          this.value = \"\";\n          this.control.value = \"\";\n          this.filter = \"\";\n          this.filterOptions();\n          break;\n        }\n\n      case \"Tab\":\n        {\n          this.setInputToSelection();\n\n          if (!this.open) {\n            return true;\n          }\n\n          e.preventDefault();\n          this.open = false;\n          break;\n        }\n\n      case \"ArrowUp\":\n      case \"ArrowDown\":\n        {\n          this.filterOptions();\n\n          if (!this.open) {\n            this.open = true;\n            break;\n          }\n\n          if (this.filteredOptions.length > 0) {\n            super.keydownHandler(e);\n          }\n\n          if (this.isAutocompleteInline) {\n            this.setInlineSelection();\n          }\n\n          break;\n        }\n\n      default:\n        {\n          return true;\n        }\n    }\n  }\n  /**\n   * Handle keyup actions for value input and text field manipulations.\n   *\n   * @param e - the keyboard event\n   * @internal\n   */\n\n\n  keyupHandler(e) {\n    const key = e.key;\n\n    switch (key) {\n      case \"ArrowLeft\":\n      case \"ArrowRight\":\n      case \"Backspace\":\n      case \"Delete\":\n      case \"Home\":\n      case \"End\":\n        {\n          this.filter = this.control.value;\n          this.selectedIndex = -1;\n          this.filterOptions();\n          break;\n        }\n    }\n  }\n  /**\n   * Ensure that the selectedIndex is within the current allowable filtered range.\n   *\n   * @param prev - the previous selected index value\n   * @param next - the current selected index value\n   *\n   * @internal\n   */\n\n\n  selectedIndexChanged(prev, next) {\n    if (this.$fastController.isConnected) {\n      next = limit(-1, this.options.length - 1, next); // we only want to call the super method when the selectedIndex is in range\n\n      if (next !== this.selectedIndex) {\n        this.selectedIndex = next;\n        return;\n      }\n\n      super.selectedIndexChanged(prev, next);\n    }\n  }\n  /**\n   * Move focus to the previous selectable option.\n   *\n   * @internal\n   * @remarks\n   * Overrides `Listbox.selectPreviousOption`\n   */\n\n\n  selectPreviousOption() {\n    if (!this.disabled && this.selectedIndex >= 0) {\n      this.selectedIndex = this.selectedIndex - 1;\n    }\n  }\n  /**\n   * Set the default selected options at initialization or reset.\n   *\n   * @internal\n   * @remarks\n   * Overrides `Listbox.setDefaultSelectedOption`\n   */\n\n\n  setDefaultSelectedOption() {\n    if (this.$fastController.isConnected && this.options) {\n      const selectedIndex = this.options.findIndex(el => el.getAttribute(\"selected\") !== null || el.selected);\n      this.selectedIndex = selectedIndex;\n\n      if (!this.dirtyValue && this.firstSelectedOption) {\n        this.value = this.firstSelectedOption.text;\n      }\n\n      this.setSelectedOptions();\n    }\n  }\n  /**\n   * Focus and set the content of the control based on the first selected option.\n   *\n   * @internal\n   */\n\n\n  setInputToSelection() {\n    if (this.firstSelectedOption) {\n      this.control.value = this.firstSelectedOption.text;\n      this.control.focus();\n    }\n  }\n  /**\n   * Focus, set and select the content of the control based on the first selected option.\n   *\n   * @internal\n   */\n\n\n  setInlineSelection() {\n    if (this.firstSelectedOption) {\n      this.setInputToSelection();\n      this.control.setSelectionRange(this.filter.length, this.control.value.length, \"backward\");\n    }\n  }\n  /**\n   * Determines if a value update should involve emitting a change event, then updates the value.\n   *\n   * @internal\n   */\n\n\n  syncValue() {\n    var _a;\n\n    const newValue = this.selectedIndex > -1 ? (_a = this.firstSelectedOption) === null || _a === void 0 ? void 0 : _a.text : this.control.value;\n    this.updateValue(this.value !== newValue);\n  }\n  /**\n   * Calculate and apply listbox positioning based on available viewport space.\n   *\n   * @param force - direction to force the listbox to display\n   * @public\n   */\n\n\n  setPositioning() {\n    const currentBox = this.getBoundingClientRect();\n    const viewportHeight = window.innerHeight;\n    const availableBottom = viewportHeight - currentBox.bottom;\n    this.position = this.forcedPosition ? this.positionAttribute : currentBox.top > availableBottom ? SelectPosition.above : SelectPosition.below;\n    this.positionAttribute = this.forcedPosition ? this.positionAttribute : this.position;\n    this.maxHeight = this.position === SelectPosition.above ? ~~currentBox.top : ~~availableBottom;\n  }\n  /**\n   * Ensure that the entire list of options is used when setting the selected property.\n   *\n   * @param prev - the previous list of selected options\n   * @param next - the current list of selected options\n   *\n   * @internal\n   * @remarks\n   * Overrides: `Listbox.selectedOptionsChanged`\n   */\n\n\n  selectedOptionsChanged(prev, next) {\n    if (this.$fastController.isConnected) {\n      this._options.forEach(o => {\n        o.selected = next.includes(o);\n      });\n    }\n  }\n  /**\n   * Synchronize the form-associated proxy and update the value property of the element.\n   *\n   * @param prev - the previous collection of slotted option elements\n   * @param next - the next collection of slotted option elements\n   *\n   * @internal\n   */\n\n\n  slottedOptionsChanged(prev, next) {\n    super.slottedOptionsChanged(prev, next);\n    this.updateValue();\n  }\n  /**\n   * Sets the value and to match the first selected option.\n   *\n   * @param shouldEmit - if true, the change event will be emitted\n   *\n   * @internal\n   */\n\n\n  updateValue(shouldEmit) {\n    var _a;\n\n    if (this.$fastController.isConnected) {\n      this.value = ((_a = this.firstSelectedOption) === null || _a === void 0 ? void 0 : _a.text) || this.control.value;\n      this.control.value = this.value;\n    }\n\n    if (shouldEmit) {\n      this.$emit(\"change\");\n    }\n  }\n  /**\n   * @internal\n   */\n\n\n  clearSelectionRange() {\n    const controlValueLength = this.control.value.length;\n    this.control.setSelectionRange(controlValueLength, controlValueLength);\n  }\n\n}\n\n__decorate([attr({\n  attribute: \"autocomplete\",\n  mode: \"fromView\"\n})], Combobox.prototype, \"autocomplete\", void 0);\n\n__decorate([observable], Combobox.prototype, \"maxHeight\", void 0);\n\n__decorate([attr({\n  attribute: \"open\",\n  mode: \"boolean\"\n})], Combobox.prototype, \"open\", void 0);\n\n__decorate([attr], Combobox.prototype, \"placeholder\", void 0);\n\n__decorate([attr({\n  attribute: \"position\"\n})], Combobox.prototype, \"positionAttribute\", void 0);\n\n__decorate([observable], Combobox.prototype, \"position\", void 0);\n/**\n * Includes ARIA states and properties relating to the ARIA combobox role.\n *\n * @public\n */\n\n\nexport class DelegatesARIACombobox {}\n\n__decorate([observable], DelegatesARIACombobox.prototype, \"ariaAutoComplete\", void 0);\n\n__decorate([observable], DelegatesARIACombobox.prototype, \"ariaControls\", void 0);\n\napplyMixins(DelegatesARIACombobox, DelegatesARIAListbox);\napplyMixins(Combobox, StartEnd, DelegatesARIACombobox);","map":{"version":3,"names":["__decorate","attr","DOM","Observable","observable","limit","uniqueId","DelegatesARIAListbox","StartEnd","SelectPosition","applyMixins","FormAssociatedCombobox","ComboboxAutocomplete","Combobox","constructor","arguments","_value","filteredOptions","filter","forcedPosition","listboxId","maxHeight","open","formResetCallback","setDefaultSelectedOption","updateValue","validate","control","isAutocompleteInline","autocomplete","inline","isAutocompleteBoth","isAutocompleteList","list","both","openChanged","ariaControls","ariaExpanded","setPositioning","focusAndScrollOptionIntoView","queueUpdate","focus","options","track","length","_options","value","notify","placeholderChanged","proxy","HTMLInputElement","placeholder","positionChanged","prev","next","positionAttribute","_a","_b","_c","$fastController","isConnected","selectedIndex","findIndex","el","text","toLowerCase","prevSelectedValue","nextSelectedValue","firstSelectedOption","valueChanged","clickHandler","e","disabled","captured","target","closest","selectedOptions","clearSelectionRange","connectedCallback","initialValue","disabledChanged","ariaDisabled","filterOptions","none","o","startsWith","forEach","hidden","includes","contains","document","activeElement","requestAnimationFrame","scrollIntoView","block","focusoutHandler","syncValue","focusTarget","relatedTarget","isSameNode","inputHandler","map","option","indexOf","inputType","setInlineSelection","keydownHandler","key","ctrlKey","shiftKey","setInputToSelection","preventDefault","keyupHandler","selectedIndexChanged","selectPreviousOption","getAttribute","selected","dirtyValue","setSelectedOptions","setSelectionRange","newValue","currentBox","getBoundingClientRect","viewportHeight","window","innerHeight","availableBottom","bottom","position","top","above","below","selectedOptionsChanged","slottedOptionsChanged","shouldEmit","$emit","controlValueLength","attribute","mode","prototype","DelegatesARIACombobox"],"sources":["/Users/gaborcsardi/works/rig/vscode/webview-ui/node_modules/@microsoft/fast-foundation/dist/esm/combobox/combobox.js"],"sourcesContent":["import { __decorate } from \"tslib\";\nimport { attr, DOM, Observable, observable } from \"@microsoft/fast-element\";\nimport { limit, uniqueId } from \"@microsoft/fast-web-utilities\";\nimport { DelegatesARIAListbox } from \"../listbox/listbox.js\";\nimport { StartEnd } from \"../patterns/start-end.js\";\nimport { SelectPosition } from \"../select/select.options.js\";\nimport { applyMixins } from \"../utilities/apply-mixins.js\";\nimport { FormAssociatedCombobox } from \"./combobox.form-associated.js\";\nimport { ComboboxAutocomplete } from \"./combobox.options.js\";\n/**\n * A Combobox Custom HTML Element.\n * Implements the {@link https://w3c.github.io/aria-practices/#combobox | ARIA combobox }.\n *\n * @slot start - Content which can be provided before the input\n * @slot end - Content which can be provided after the input\n * @slot control - Used to replace the input element representing the combobox\n * @slot indicator - The visual indicator representing the expanded state\n * @slot - The default slot for the options\n * @csspart control - The wrapper element containing the input area, including start and end\n * @csspart selected-value - The input element representing the selected value\n * @csspart indicator - The element wrapping the indicator slot\n * @csspart listbox - The wrapper for the listbox slotted options\n * @fires change - Fires a custom 'change' event when the value updates\n *\n * @public\n */\nexport class Combobox extends FormAssociatedCombobox {\n    constructor() {\n        super(...arguments);\n        /**\n         * The internal value property.\n         *\n         * @internal\n         */\n        this._value = \"\";\n        /**\n         * The collection of currently filtered options.\n         *\n         * @public\n         */\n        this.filteredOptions = [];\n        /**\n         * The current filter value.\n         *\n         * @internal\n         */\n        this.filter = \"\";\n        /**\n         * The initial state of the position attribute.\n         *\n         * @internal\n         */\n        this.forcedPosition = false;\n        /**\n         * The unique id for the internal listbox element.\n         *\n         * @internal\n         */\n        this.listboxId = uniqueId(\"listbox-\");\n        /**\n         * The max height for the listbox when opened.\n         *\n         * @internal\n         */\n        this.maxHeight = 0;\n        /**\n         * The open attribute.\n         *\n         * @public\n         * @remarks\n         * HTML Attribute: open\n         */\n        this.open = false;\n    }\n    /**\n     * Reset the element to its first selectable option when its parent form is reset.\n     *\n     * @internal\n     */\n    formResetCallback() {\n        super.formResetCallback();\n        this.setDefaultSelectedOption();\n        this.updateValue();\n    }\n    /** {@inheritDoc (FormAssociated:interface).validate} */\n    validate() {\n        super.validate(this.control);\n    }\n    get isAutocompleteInline() {\n        return (this.autocomplete === ComboboxAutocomplete.inline || this.isAutocompleteBoth);\n    }\n    get isAutocompleteList() {\n        return this.autocomplete === ComboboxAutocomplete.list || this.isAutocompleteBoth;\n    }\n    get isAutocompleteBoth() {\n        return this.autocomplete === ComboboxAutocomplete.both;\n    }\n    /**\n     * Sets focus and synchronize ARIA attributes when the open property changes.\n     *\n     * @param prev - the previous open value\n     * @param next - the current open value\n     *\n     * @internal\n     */\n    openChanged() {\n        if (this.open) {\n            this.ariaControls = this.listboxId;\n            this.ariaExpanded = \"true\";\n            this.setPositioning();\n            this.focusAndScrollOptionIntoView();\n            // focus is directed to the element when `open` is changed programmatically\n            DOM.queueUpdate(() => this.focus());\n            return;\n        }\n        this.ariaControls = \"\";\n        this.ariaExpanded = \"false\";\n    }\n    /**\n     * The list of options.\n     *\n     * @public\n     * @remarks\n     * Overrides `Listbox.options`.\n     */\n    get options() {\n        Observable.track(this, \"options\");\n        return this.filteredOptions.length ? this.filteredOptions : this._options;\n    }\n    set options(value) {\n        this._options = value;\n        Observable.notify(this, \"options\");\n    }\n    /**\n     * Updates the placeholder on the proxy element.\n     * @internal\n     */\n    placeholderChanged() {\n        if (this.proxy instanceof HTMLInputElement) {\n            this.proxy.placeholder = this.placeholder;\n        }\n    }\n    positionChanged(prev, next) {\n        this.positionAttribute = next;\n        this.setPositioning();\n    }\n    /**\n     * The value property.\n     *\n     * @public\n     */\n    get value() {\n        Observable.track(this, \"value\");\n        return this._value;\n    }\n    set value(next) {\n        var _a, _b, _c;\n        const prev = `${this._value}`;\n        if (this.$fastController.isConnected && this.options) {\n            const selectedIndex = this.options.findIndex(el => el.text.toLowerCase() === next.toLowerCase());\n            const prevSelectedValue = (_a = this.options[this.selectedIndex]) === null || _a === void 0 ? void 0 : _a.text;\n            const nextSelectedValue = (_b = this.options[selectedIndex]) === null || _b === void 0 ? void 0 : _b.text;\n            this.selectedIndex =\n                prevSelectedValue !== nextSelectedValue\n                    ? selectedIndex\n                    : this.selectedIndex;\n            next = ((_c = this.firstSelectedOption) === null || _c === void 0 ? void 0 : _c.text) || next;\n        }\n        if (prev !== next) {\n            this._value = next;\n            super.valueChanged(prev, next);\n            Observable.notify(this, \"value\");\n        }\n    }\n    /**\n     * Handle opening and closing the listbox when the combobox is clicked.\n     *\n     * @param e - the mouse event\n     * @internal\n     */\n    clickHandler(e) {\n        if (this.disabled) {\n            return;\n        }\n        if (this.open) {\n            const captured = e.target.closest(`option,[role=option]`);\n            if (!captured || captured.disabled) {\n                return;\n            }\n            this.selectedOptions = [captured];\n            this.control.value = captured.text;\n            this.clearSelectionRange();\n            this.updateValue(true);\n        }\n        this.open = !this.open;\n        if (this.open) {\n            this.control.focus();\n        }\n        return true;\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        this.forcedPosition = !!this.positionAttribute;\n        if (this.value) {\n            this.initialValue = this.value;\n        }\n    }\n    /**\n     * Synchronize the `aria-disabled` property when the `disabled` property changes.\n     *\n     * @param prev - The previous disabled value\n     * @param next - The next disabled value\n     *\n     * @internal\n     */\n    disabledChanged(prev, next) {\n        if (super.disabledChanged) {\n            super.disabledChanged(prev, next);\n        }\n        this.ariaDisabled = this.disabled ? \"true\" : \"false\";\n    }\n    /**\n     * Filter available options by text value.\n     *\n     * @public\n     */\n    filterOptions() {\n        if (!this.autocomplete || this.autocomplete === ComboboxAutocomplete.none) {\n            this.filter = \"\";\n        }\n        const filter = this.filter.toLowerCase();\n        this.filteredOptions = this._options.filter(o => o.text.toLowerCase().startsWith(this.filter.toLowerCase()));\n        if (this.isAutocompleteList) {\n            if (!this.filteredOptions.length && !filter) {\n                this.filteredOptions = this._options;\n            }\n            this._options.forEach(o => {\n                o.hidden = !this.filteredOptions.includes(o);\n            });\n        }\n    }\n    /**\n     * Focus the control and scroll the first selected option into view.\n     *\n     * @internal\n     * @remarks\n     * Overrides: `Listbox.focusAndScrollOptionIntoView`\n     */\n    focusAndScrollOptionIntoView() {\n        if (this.contains(document.activeElement)) {\n            this.control.focus();\n            if (this.firstSelectedOption) {\n                requestAnimationFrame(() => {\n                    var _a;\n                    (_a = this.firstSelectedOption) === null || _a === void 0 ? void 0 : _a.scrollIntoView({ block: \"nearest\" });\n                });\n            }\n        }\n    }\n    /**\n     * Handle focus state when the element or its children lose focus.\n     *\n     * @param e - The focus event\n     * @internal\n     */\n    focusoutHandler(e) {\n        this.syncValue();\n        if (!this.open) {\n            return true;\n        }\n        const focusTarget = e.relatedTarget;\n        if (this.isSameNode(focusTarget)) {\n            this.focus();\n            return;\n        }\n        if (!this.options || !this.options.includes(focusTarget)) {\n            this.open = false;\n        }\n    }\n    /**\n     * Handle content changes on the control input.\n     *\n     * @param e - the input event\n     * @internal\n     */\n    inputHandler(e) {\n        this.filter = this.control.value;\n        this.filterOptions();\n        if (!this.isAutocompleteInline) {\n            this.selectedIndex = this.options\n                .map(option => option.text)\n                .indexOf(this.control.value);\n        }\n        if (e.inputType.includes(\"deleteContent\") || !this.filter.length) {\n            return true;\n        }\n        if (this.isAutocompleteList && !this.open) {\n            this.open = true;\n        }\n        if (this.isAutocompleteInline) {\n            if (this.filteredOptions.length) {\n                this.selectedOptions = [this.filteredOptions[0]];\n                this.selectedIndex = this.options.indexOf(this.firstSelectedOption);\n                this.setInlineSelection();\n            }\n            else {\n                this.selectedIndex = -1;\n            }\n        }\n        return;\n    }\n    /**\n     * Handle keydown actions for listbox navigation.\n     *\n     * @param e - the keyboard event\n     * @internal\n     */\n    keydownHandler(e) {\n        const key = e.key;\n        if (e.ctrlKey || e.shiftKey) {\n            return true;\n        }\n        switch (key) {\n            case \"Enter\": {\n                this.syncValue();\n                if (this.isAutocompleteInline) {\n                    this.filter = this.value;\n                }\n                this.open = false;\n                this.clearSelectionRange();\n                break;\n            }\n            case \"Escape\": {\n                if (!this.isAutocompleteInline) {\n                    this.selectedIndex = -1;\n                }\n                if (this.open) {\n                    this.open = false;\n                    break;\n                }\n                this.value = \"\";\n                this.control.value = \"\";\n                this.filter = \"\";\n                this.filterOptions();\n                break;\n            }\n            case \"Tab\": {\n                this.setInputToSelection();\n                if (!this.open) {\n                    return true;\n                }\n                e.preventDefault();\n                this.open = false;\n                break;\n            }\n            case \"ArrowUp\":\n            case \"ArrowDown\": {\n                this.filterOptions();\n                if (!this.open) {\n                    this.open = true;\n                    break;\n                }\n                if (this.filteredOptions.length > 0) {\n                    super.keydownHandler(e);\n                }\n                if (this.isAutocompleteInline) {\n                    this.setInlineSelection();\n                }\n                break;\n            }\n            default: {\n                return true;\n            }\n        }\n    }\n    /**\n     * Handle keyup actions for value input and text field manipulations.\n     *\n     * @param e - the keyboard event\n     * @internal\n     */\n    keyupHandler(e) {\n        const key = e.key;\n        switch (key) {\n            case \"ArrowLeft\":\n            case \"ArrowRight\":\n            case \"Backspace\":\n            case \"Delete\":\n            case \"Home\":\n            case \"End\": {\n                this.filter = this.control.value;\n                this.selectedIndex = -1;\n                this.filterOptions();\n                break;\n            }\n        }\n    }\n    /**\n     * Ensure that the selectedIndex is within the current allowable filtered range.\n     *\n     * @param prev - the previous selected index value\n     * @param next - the current selected index value\n     *\n     * @internal\n     */\n    selectedIndexChanged(prev, next) {\n        if (this.$fastController.isConnected) {\n            next = limit(-1, this.options.length - 1, next);\n            // we only want to call the super method when the selectedIndex is in range\n            if (next !== this.selectedIndex) {\n                this.selectedIndex = next;\n                return;\n            }\n            super.selectedIndexChanged(prev, next);\n        }\n    }\n    /**\n     * Move focus to the previous selectable option.\n     *\n     * @internal\n     * @remarks\n     * Overrides `Listbox.selectPreviousOption`\n     */\n    selectPreviousOption() {\n        if (!this.disabled && this.selectedIndex >= 0) {\n            this.selectedIndex = this.selectedIndex - 1;\n        }\n    }\n    /**\n     * Set the default selected options at initialization or reset.\n     *\n     * @internal\n     * @remarks\n     * Overrides `Listbox.setDefaultSelectedOption`\n     */\n    setDefaultSelectedOption() {\n        if (this.$fastController.isConnected && this.options) {\n            const selectedIndex = this.options.findIndex(el => el.getAttribute(\"selected\") !== null || el.selected);\n            this.selectedIndex = selectedIndex;\n            if (!this.dirtyValue && this.firstSelectedOption) {\n                this.value = this.firstSelectedOption.text;\n            }\n            this.setSelectedOptions();\n        }\n    }\n    /**\n     * Focus and set the content of the control based on the first selected option.\n     *\n     * @internal\n     */\n    setInputToSelection() {\n        if (this.firstSelectedOption) {\n            this.control.value = this.firstSelectedOption.text;\n            this.control.focus();\n        }\n    }\n    /**\n     * Focus, set and select the content of the control based on the first selected option.\n     *\n     * @internal\n     */\n    setInlineSelection() {\n        if (this.firstSelectedOption) {\n            this.setInputToSelection();\n            this.control.setSelectionRange(this.filter.length, this.control.value.length, \"backward\");\n        }\n    }\n    /**\n     * Determines if a value update should involve emitting a change event, then updates the value.\n     *\n     * @internal\n     */\n    syncValue() {\n        var _a;\n        const newValue = this.selectedIndex > -1 ? (_a = this.firstSelectedOption) === null || _a === void 0 ? void 0 : _a.text : this.control.value;\n        this.updateValue(this.value !== newValue);\n    }\n    /**\n     * Calculate and apply listbox positioning based on available viewport space.\n     *\n     * @param force - direction to force the listbox to display\n     * @public\n     */\n    setPositioning() {\n        const currentBox = this.getBoundingClientRect();\n        const viewportHeight = window.innerHeight;\n        const availableBottom = viewportHeight - currentBox.bottom;\n        this.position = this.forcedPosition\n            ? this.positionAttribute\n            : currentBox.top > availableBottom\n                ? SelectPosition.above\n                : SelectPosition.below;\n        this.positionAttribute = this.forcedPosition\n            ? this.positionAttribute\n            : this.position;\n        this.maxHeight =\n            this.position === SelectPosition.above ? ~~currentBox.top : ~~availableBottom;\n    }\n    /**\n     * Ensure that the entire list of options is used when setting the selected property.\n     *\n     * @param prev - the previous list of selected options\n     * @param next - the current list of selected options\n     *\n     * @internal\n     * @remarks\n     * Overrides: `Listbox.selectedOptionsChanged`\n     */\n    selectedOptionsChanged(prev, next) {\n        if (this.$fastController.isConnected) {\n            this._options.forEach(o => {\n                o.selected = next.includes(o);\n            });\n        }\n    }\n    /**\n     * Synchronize the form-associated proxy and update the value property of the element.\n     *\n     * @param prev - the previous collection of slotted option elements\n     * @param next - the next collection of slotted option elements\n     *\n     * @internal\n     */\n    slottedOptionsChanged(prev, next) {\n        super.slottedOptionsChanged(prev, next);\n        this.updateValue();\n    }\n    /**\n     * Sets the value and to match the first selected option.\n     *\n     * @param shouldEmit - if true, the change event will be emitted\n     *\n     * @internal\n     */\n    updateValue(shouldEmit) {\n        var _a;\n        if (this.$fastController.isConnected) {\n            this.value = ((_a = this.firstSelectedOption) === null || _a === void 0 ? void 0 : _a.text) || this.control.value;\n            this.control.value = this.value;\n        }\n        if (shouldEmit) {\n            this.$emit(\"change\");\n        }\n    }\n    /**\n     * @internal\n     */\n    clearSelectionRange() {\n        const controlValueLength = this.control.value.length;\n        this.control.setSelectionRange(controlValueLength, controlValueLength);\n    }\n}\n__decorate([\n    attr({ attribute: \"autocomplete\", mode: \"fromView\" })\n], Combobox.prototype, \"autocomplete\", void 0);\n__decorate([\n    observable\n], Combobox.prototype, \"maxHeight\", void 0);\n__decorate([\n    attr({ attribute: \"open\", mode: \"boolean\" })\n], Combobox.prototype, \"open\", void 0);\n__decorate([\n    attr\n], Combobox.prototype, \"placeholder\", void 0);\n__decorate([\n    attr({ attribute: \"position\" })\n], Combobox.prototype, \"positionAttribute\", void 0);\n__decorate([\n    observable\n], Combobox.prototype, \"position\", void 0);\n/**\n * Includes ARIA states and properties relating to the ARIA combobox role.\n *\n * @public\n */\nexport class DelegatesARIACombobox {\n}\n__decorate([\n    observable\n], DelegatesARIACombobox.prototype, \"ariaAutoComplete\", void 0);\n__decorate([\n    observable\n], DelegatesARIACombobox.prototype, \"ariaControls\", void 0);\napplyMixins(DelegatesARIACombobox, DelegatesARIAListbox);\napplyMixins(Combobox, StartEnd, DelegatesARIACombobox);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}