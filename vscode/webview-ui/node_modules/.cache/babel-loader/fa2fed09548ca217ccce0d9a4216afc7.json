{"ast":null,"code":"/**\n * A utility wrapper around the acquireVsCodeApi() function, which enables\n * message passing and state management between the webview and extension\n * contexts.\n *\n * This utility also enables webview code to be run in a web browser-based\n * dev server by using native web browser features that mock the functionality\n * enabled by acquireVsCodeApi.\n */\nclass VSCodeAPIWrapper {\n  constructor() {\n    this.vsCodeApi = void 0;\n\n    // Check if the acquireVsCodeApi function exists in the current development\n    // context (i.e. VS Code development window or web browser)\n    if (typeof acquireVsCodeApi === \"function\") {\n      this.vsCodeApi = acquireVsCodeApi();\n    }\n  }\n  /**\n   * Post a message (i.e. send arbitrary data) to the owner of the webview.\n   *\n   * @remarks When running webview code inside a web browser, postMessage will instead\n   * log the given message to the console.\n   *\n   * @param message Abitrary data (must be JSON serializable) to send to the extension context.\n   */\n\n\n  postMessage(message) {\n    if (this.vsCodeApi) {\n      this.vsCodeApi.postMessage(message);\n    } else {\n      console.log(message);\n    }\n  }\n  /**\n   * Get the persistent state stored for this webview.\n   *\n   * @remarks When running webview source code inside a web browser, getState will retrieve state\n   * from local storage (https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage).\n   *\n   * @return The current state or `undefined` if no state has been set.\n   */\n\n\n  getState() {\n    if (this.vsCodeApi) {\n      return this.vsCodeApi.getState();\n    } else {\n      const state = localStorage.getItem(\"vscodeState\");\n      return state ? JSON.parse(state) : undefined;\n    }\n  }\n  /**\n   * Set the persistent state stored for this webview.\n   *\n   * @remarks When running webview source code inside a web browser, setState will set the given\n   * state using local storage (https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage).\n   *\n   * @param newState New persisted state. This must be a JSON serializable object. Can be retrieved\n   * using {@link getState}.\n   *\n   * @return The new state.\n   */\n\n\n  setState(newState) {\n    if (this.vsCodeApi) {\n      return this.vsCodeApi.setState(newState);\n    } else {\n      localStorage.setItem(\"vscodeState\", JSON.stringify(newState));\n      return newState;\n    }\n  }\n\n} // Exports class singleton to prevent multiple invocations of acquireVsCodeApi.\n\n\nexport const vscode = new VSCodeAPIWrapper();","map":{"version":3,"names":["VSCodeAPIWrapper","constructor","vsCodeApi","acquireVsCodeApi","postMessage","message","console","log","getState","state","localStorage","getItem","JSON","parse","undefined","setState","newState","setItem","stringify","vscode"],"sources":["/Users/gaborcsardi/works/rig/vscode/webview-ui/src/utilities/vscode.ts"],"sourcesContent":["import type { WebviewApi } from \"vscode-webview\";\n\n/**\n * A utility wrapper around the acquireVsCodeApi() function, which enables\n * message passing and state management between the webview and extension\n * contexts.\n *\n * This utility also enables webview code to be run in a web browser-based\n * dev server by using native web browser features that mock the functionality\n * enabled by acquireVsCodeApi.\n */\nclass VSCodeAPIWrapper {\n  private readonly vsCodeApi: WebviewApi<unknown> | undefined;\n\n  constructor() {\n    // Check if the acquireVsCodeApi function exists in the current development\n    // context (i.e. VS Code development window or web browser)\n    if (typeof acquireVsCodeApi === \"function\") {\n      this.vsCodeApi = acquireVsCodeApi();\n    }\n  }\n\n  /**\n   * Post a message (i.e. send arbitrary data) to the owner of the webview.\n   *\n   * @remarks When running webview code inside a web browser, postMessage will instead\n   * log the given message to the console.\n   *\n   * @param message Abitrary data (must be JSON serializable) to send to the extension context.\n   */\n  public postMessage(message: unknown) {\n    if (this.vsCodeApi) {\n      this.vsCodeApi.postMessage(message);\n    } else {\n      console.log(message);\n    }\n  }\n\n  /**\n   * Get the persistent state stored for this webview.\n   *\n   * @remarks When running webview source code inside a web browser, getState will retrieve state\n   * from local storage (https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage).\n   *\n   * @return The current state or `undefined` if no state has been set.\n   */\n  public getState(): unknown | undefined {\n    if (this.vsCodeApi) {\n      return this.vsCodeApi.getState();\n    } else {\n      const state = localStorage.getItem(\"vscodeState\");\n      return state ? JSON.parse(state) : undefined;\n    }\n  }\n\n  /**\n   * Set the persistent state stored for this webview.\n   *\n   * @remarks When running webview source code inside a web browser, setState will set the given\n   * state using local storage (https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage).\n   *\n   * @param newState New persisted state. This must be a JSON serializable object. Can be retrieved\n   * using {@link getState}.\n   *\n   * @return The new state.\n   */\n  public setState<T extends unknown | undefined>(newState: T): T {\n    if (this.vsCodeApi) {\n      return this.vsCodeApi.setState(newState);\n    } else {\n      localStorage.setItem(\"vscodeState\", JSON.stringify(newState));\n      return newState;\n    }\n  }\n}\n\n// Exports class singleton to prevent multiple invocations of acquireVsCodeApi.\nexport const vscode = new VSCodeAPIWrapper();\n"],"mappings":"AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMA,gBAAN,CAAuB;EAGrBC,WAAW,GAAG;IAAA,KAFGC,SAEH;;IACZ;IACA;IACA,IAAI,OAAOC,gBAAP,KAA4B,UAAhC,EAA4C;MAC1C,KAAKD,SAAL,GAAiBC,gBAAgB,EAAjC;IACD;EACF;EAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;;EACSC,WAAW,CAACC,OAAD,EAAmB;IACnC,IAAI,KAAKH,SAAT,EAAoB;MAClB,KAAKA,SAAL,CAAeE,WAAf,CAA2BC,OAA3B;IACD,CAFD,MAEO;MACLC,OAAO,CAACC,GAAR,CAAYF,OAAZ;IACD;EACF;EAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;;EACSG,QAAQ,GAAwB;IACrC,IAAI,KAAKN,SAAT,EAAoB;MAClB,OAAO,KAAKA,SAAL,CAAeM,QAAf,EAAP;IACD,CAFD,MAEO;MACL,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqB,aAArB,CAAd;MACA,OAAOF,KAAK,GAAGG,IAAI,CAACC,KAAL,CAAWJ,KAAX,CAAH,GAAuBK,SAAnC;IACD;EACF;EAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;EACSC,QAAQ,CAAgCC,QAAhC,EAAgD;IAC7D,IAAI,KAAKd,SAAT,EAAoB;MAClB,OAAO,KAAKA,SAAL,CAAea,QAAf,CAAwBC,QAAxB,CAAP;IACD,CAFD,MAEO;MACLN,YAAY,CAACO,OAAb,CAAqB,aAArB,EAAoCL,IAAI,CAACM,SAAL,CAAeF,QAAf,CAApC;MACA,OAAOA,QAAP;IACD;EACF;;AA9DoB,C,CAiEvB;;;AACA,OAAO,MAAMG,MAAM,GAAG,IAAInB,gBAAJ,EAAf"},"metadata":{},"sourceType":"module"}