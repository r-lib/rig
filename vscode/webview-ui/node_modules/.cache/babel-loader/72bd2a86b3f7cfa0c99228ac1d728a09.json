{"ast":null,"code":"import _classCallCheck from \"/Users/gaborcsardi/works/rig/vscode/webview-ui/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/gaborcsardi/works/rig/vscode/webview-ui/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport { DOM } from \"../dom.js\";\nimport { defaultExecutionContext } from \"../observation/observable.js\";\nimport { compileTemplate } from \"./compiler.js\";\nimport { HTMLView } from \"./view.js\";\nimport { HTMLDirective, TargetedHTMLDirective } from \"./html-directive.js\";\nimport { HTMLBindingDirective } from \"./binding.js\";\n/**\n * A template capable of creating HTMLView instances or rendering directly to DOM.\n * @public\n */\n\n/* eslint-disable-next-line @typescript-eslint/no-unused-vars */\n\nexport var ViewTemplate = /*#__PURE__*/function () {\n  /**\n   * Creates an instance of ViewTemplate.\n   * @param html - The html representing what this template will instantiate, including placeholders for directives.\n   * @param directives - The directives that will be connected to placeholders in the html.\n   */\n  function ViewTemplate(html, directives) {\n    _classCallCheck(this, ViewTemplate);\n\n    this.behaviorCount = 0;\n    this.hasHostBehaviors = false;\n    this.fragment = null;\n    this.targetOffset = 0;\n    this.viewBehaviorFactories = null;\n    this.hostBehaviorFactories = null;\n    this.html = html;\n    this.directives = directives;\n  }\n  /**\n   * Creates an HTMLView instance based on this template definition.\n   * @param hostBindingTarget - The element that host behaviors will be bound to.\n   */\n\n\n  _createClass(ViewTemplate, [{\n    key: \"create\",\n    value: function create(hostBindingTarget) {\n      if (this.fragment === null) {\n        var template;\n        var _html = this.html;\n\n        if (typeof _html === \"string\") {\n          template = document.createElement(\"template\");\n          template.innerHTML = DOM.createHTML(_html);\n          var fec = template.content.firstElementChild;\n\n          if (fec !== null && fec.tagName === \"TEMPLATE\") {\n            template = fec;\n          }\n        } else {\n          template = _html;\n        }\n\n        var result = compileTemplate(template, this.directives);\n        this.fragment = result.fragment;\n        this.viewBehaviorFactories = result.viewBehaviorFactories;\n        this.hostBehaviorFactories = result.hostBehaviorFactories;\n        this.targetOffset = result.targetOffset;\n        this.behaviorCount = this.viewBehaviorFactories.length + this.hostBehaviorFactories.length;\n        this.hasHostBehaviors = this.hostBehaviorFactories.length > 0;\n      }\n\n      var fragment = this.fragment.cloneNode(true);\n      var viewFactories = this.viewBehaviorFactories;\n      var behaviors = new Array(this.behaviorCount);\n      var walker = DOM.createTemplateWalker(fragment);\n      var behaviorIndex = 0;\n      var targetIndex = this.targetOffset;\n      var node = walker.nextNode();\n\n      for (var ii = viewFactories.length; behaviorIndex < ii; ++behaviorIndex) {\n        var factory = viewFactories[behaviorIndex];\n        var factoryIndex = factory.targetIndex;\n\n        while (node !== null) {\n          if (targetIndex === factoryIndex) {\n            behaviors[behaviorIndex] = factory.createBehavior(node);\n            break;\n          } else {\n            node = walker.nextNode();\n            targetIndex++;\n          }\n        }\n      }\n\n      if (this.hasHostBehaviors) {\n        var hostFactories = this.hostBehaviorFactories;\n\n        for (var i = 0, _ii = hostFactories.length; i < _ii; ++i, ++behaviorIndex) {\n          behaviors[behaviorIndex] = hostFactories[i].createBehavior(hostBindingTarget);\n        }\n      }\n\n      return new HTMLView(fragment, behaviors);\n    }\n    /**\n     * Creates an HTMLView from this template, binds it to the source, and then appends it to the host.\n     * @param source - The data source to bind the template to.\n     * @param host - The Element where the template will be rendered.\n     * @param hostBindingTarget - An HTML element to target the host bindings at if different from the\n     * host that the template is being attached to.\n     */\n\n  }, {\n    key: \"render\",\n    value: function render(source, host, hostBindingTarget) {\n      if (typeof host === \"string\") {\n        host = document.getElementById(host);\n      }\n\n      if (hostBindingTarget === void 0) {\n        hostBindingTarget = host;\n      }\n\n      var view = this.create(hostBindingTarget);\n      view.bind(source, defaultExecutionContext);\n      view.appendTo(host);\n      return view;\n    }\n  }]);\n\n  return ViewTemplate;\n}(); // Much thanks to LitHTML for working this out!\n\nvar lastAttributeNameRegex =\n/* eslint-disable-next-line no-control-regex */\n/([ \\x09\\x0a\\x0c\\x0d])([^\\0-\\x1F\\x7F-\\x9F \"'>=/]+)([ \\x09\\x0a\\x0c\\x0d]*=[ \\x09\\x0a\\x0c\\x0d]*(?:[^ \\x09\\x0a\\x0c\\x0d\"'`<>=]*|\"[^\"]*|'[^']*))$/;\n/**\n * Transforms a template literal string into a renderable ViewTemplate.\n * @param strings - The string fragments that are interpolated with the values.\n * @param values - The values that are interpolated with the string fragments.\n * @remarks\n * The html helper supports interpolation of strings, numbers, binding expressions,\n * other template instances, and Directive instances.\n * @public\n */\n\nexport function html(strings) {\n  var directives = [];\n  var html = \"\";\n\n  for (var i = 0, ii = strings.length - 1; i < ii; ++i) {\n    var currentString = strings[i];\n    var value = i + 1 < 1 || arguments.length <= i + 1 ? undefined : arguments[i + 1];\n    html += currentString;\n\n    if (value instanceof ViewTemplate) {\n      (function () {\n        var template = value;\n\n        value = function value() {\n          return template;\n        };\n      })();\n    }\n\n    if (typeof value === \"function\") {\n      value = new HTMLBindingDirective(value);\n    }\n\n    if (value instanceof TargetedHTMLDirective) {\n      var match = lastAttributeNameRegex.exec(currentString);\n\n      if (match !== null) {\n        value.targetName = match[2];\n      }\n    }\n\n    if (value instanceof HTMLDirective) {\n      // Since not all values are directives, we can't use i\n      // as the index for the placeholder. Instead, we need to\n      // use directives.length to get the next index.\n      html += value.createPlaceholder(directives.length);\n      directives.push(value);\n    } else {\n      html += value;\n    }\n  }\n\n  html += strings[strings.length - 1];\n  return new ViewTemplate(html, directives);\n}","map":{"version":3,"names":["DOM","defaultExecutionContext","compileTemplate","HTMLView","HTMLDirective","TargetedHTMLDirective","HTMLBindingDirective","ViewTemplate","html","directives","behaviorCount","hasHostBehaviors","fragment","targetOffset","viewBehaviorFactories","hostBehaviorFactories","hostBindingTarget","template","document","createElement","innerHTML","createHTML","fec","content","firstElementChild","tagName","result","length","cloneNode","viewFactories","behaviors","Array","walker","createTemplateWalker","behaviorIndex","targetIndex","node","nextNode","ii","factory","factoryIndex","createBehavior","hostFactories","i","source","host","getElementById","view","create","bind","appendTo","lastAttributeNameRegex","strings","currentString","value","match","exec","targetName","createPlaceholder","push"],"sources":["/Users/gaborcsardi/works/rig/vscode/webview-ui/node_modules/@microsoft/fast-element/dist/esm/templating/template.js"],"sourcesContent":["import { DOM } from \"../dom.js\";\nimport { defaultExecutionContext } from \"../observation/observable.js\";\nimport { compileTemplate } from \"./compiler.js\";\nimport { HTMLView } from \"./view.js\";\nimport { HTMLDirective, TargetedHTMLDirective, } from \"./html-directive.js\";\nimport { HTMLBindingDirective } from \"./binding.js\";\n/**\n * A template capable of creating HTMLView instances or rendering directly to DOM.\n * @public\n */\n/* eslint-disable-next-line @typescript-eslint/no-unused-vars */\nexport class ViewTemplate {\n    /**\n     * Creates an instance of ViewTemplate.\n     * @param html - The html representing what this template will instantiate, including placeholders for directives.\n     * @param directives - The directives that will be connected to placeholders in the html.\n     */\n    constructor(html, directives) {\n        this.behaviorCount = 0;\n        this.hasHostBehaviors = false;\n        this.fragment = null;\n        this.targetOffset = 0;\n        this.viewBehaviorFactories = null;\n        this.hostBehaviorFactories = null;\n        this.html = html;\n        this.directives = directives;\n    }\n    /**\n     * Creates an HTMLView instance based on this template definition.\n     * @param hostBindingTarget - The element that host behaviors will be bound to.\n     */\n    create(hostBindingTarget) {\n        if (this.fragment === null) {\n            let template;\n            const html = this.html;\n            if (typeof html === \"string\") {\n                template = document.createElement(\"template\");\n                template.innerHTML = DOM.createHTML(html);\n                const fec = template.content.firstElementChild;\n                if (fec !== null && fec.tagName === \"TEMPLATE\") {\n                    template = fec;\n                }\n            }\n            else {\n                template = html;\n            }\n            const result = compileTemplate(template, this.directives);\n            this.fragment = result.fragment;\n            this.viewBehaviorFactories = result.viewBehaviorFactories;\n            this.hostBehaviorFactories = result.hostBehaviorFactories;\n            this.targetOffset = result.targetOffset;\n            this.behaviorCount =\n                this.viewBehaviorFactories.length + this.hostBehaviorFactories.length;\n            this.hasHostBehaviors = this.hostBehaviorFactories.length > 0;\n        }\n        const fragment = this.fragment.cloneNode(true);\n        const viewFactories = this.viewBehaviorFactories;\n        const behaviors = new Array(this.behaviorCount);\n        const walker = DOM.createTemplateWalker(fragment);\n        let behaviorIndex = 0;\n        let targetIndex = this.targetOffset;\n        let node = walker.nextNode();\n        for (let ii = viewFactories.length; behaviorIndex < ii; ++behaviorIndex) {\n            const factory = viewFactories[behaviorIndex];\n            const factoryIndex = factory.targetIndex;\n            while (node !== null) {\n                if (targetIndex === factoryIndex) {\n                    behaviors[behaviorIndex] = factory.createBehavior(node);\n                    break;\n                }\n                else {\n                    node = walker.nextNode();\n                    targetIndex++;\n                }\n            }\n        }\n        if (this.hasHostBehaviors) {\n            const hostFactories = this.hostBehaviorFactories;\n            for (let i = 0, ii = hostFactories.length; i < ii; ++i, ++behaviorIndex) {\n                behaviors[behaviorIndex] = hostFactories[i].createBehavior(hostBindingTarget);\n            }\n        }\n        return new HTMLView(fragment, behaviors);\n    }\n    /**\n     * Creates an HTMLView from this template, binds it to the source, and then appends it to the host.\n     * @param source - The data source to bind the template to.\n     * @param host - The Element where the template will be rendered.\n     * @param hostBindingTarget - An HTML element to target the host bindings at if different from the\n     * host that the template is being attached to.\n     */\n    render(source, host, hostBindingTarget) {\n        if (typeof host === \"string\") {\n            host = document.getElementById(host);\n        }\n        if (hostBindingTarget === void 0) {\n            hostBindingTarget = host;\n        }\n        const view = this.create(hostBindingTarget);\n        view.bind(source, defaultExecutionContext);\n        view.appendTo(host);\n        return view;\n    }\n}\n// Much thanks to LitHTML for working this out!\nconst lastAttributeNameRegex = \n/* eslint-disable-next-line no-control-regex */\n/([ \\x09\\x0a\\x0c\\x0d])([^\\0-\\x1F\\x7F-\\x9F \"'>=/]+)([ \\x09\\x0a\\x0c\\x0d]*=[ \\x09\\x0a\\x0c\\x0d]*(?:[^ \\x09\\x0a\\x0c\\x0d\"'`<>=]*|\"[^\"]*|'[^']*))$/;\n/**\n * Transforms a template literal string into a renderable ViewTemplate.\n * @param strings - The string fragments that are interpolated with the values.\n * @param values - The values that are interpolated with the string fragments.\n * @remarks\n * The html helper supports interpolation of strings, numbers, binding expressions,\n * other template instances, and Directive instances.\n * @public\n */\nexport function html(strings, ...values) {\n    const directives = [];\n    let html = \"\";\n    for (let i = 0, ii = strings.length - 1; i < ii; ++i) {\n        const currentString = strings[i];\n        let value = values[i];\n        html += currentString;\n        if (value instanceof ViewTemplate) {\n            const template = value;\n            value = () => template;\n        }\n        if (typeof value === \"function\") {\n            value = new HTMLBindingDirective(value);\n        }\n        if (value instanceof TargetedHTMLDirective) {\n            const match = lastAttributeNameRegex.exec(currentString);\n            if (match !== null) {\n                value.targetName = match[2];\n            }\n        }\n        if (value instanceof HTMLDirective) {\n            // Since not all values are directives, we can't use i\n            // as the index for the placeholder. Instead, we need to\n            // use directives.length to get the next index.\n            html += value.createPlaceholder(directives.length);\n            directives.push(value);\n        }\n        else {\n            html += value;\n        }\n    }\n    html += strings[strings.length - 1];\n    return new ViewTemplate(html, directives);\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}