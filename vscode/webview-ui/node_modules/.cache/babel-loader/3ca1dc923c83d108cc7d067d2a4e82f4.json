{"ast":null,"code":"import { Observable } from \"../observation/observable.js\";\nimport { DOM } from \"../dom.js\";\nimport { createMetadataLocator } from \"../platform.js\";\n/**\n * Metadata used to configure a custom attribute's behavior.\n * @public\n */\n\nexport const AttributeConfiguration = Object.freeze({\n  /**\n   * Locates all attribute configurations associated with a type.\n   */\n  locate: createMetadataLocator()\n});\n/**\n * A {@link ValueConverter} that converts to and from `boolean` values.\n * @remarks\n * Used automatically when the `boolean` {@link AttributeMode} is selected.\n * @public\n */\n\nexport const booleanConverter = {\n  toView(value) {\n    return value ? \"true\" : \"false\";\n  },\n\n  fromView(value) {\n    if (value === null || value === void 0 || value === \"false\" || value === false || value === 0) {\n      return false;\n    }\n\n    return true;\n  }\n\n};\n/**\n * A {@link ValueConverter} that converts to and from `number` values.\n * @remarks\n * This converter allows for nullable numbers, returning `null` if the\n * input was `null`, `undefined`, or `NaN`.\n * @public\n */\n\nexport const nullableNumberConverter = {\n  toView(value) {\n    if (value === null || value === undefined) {\n      return null;\n    }\n\n    const number = value * 1;\n    return isNaN(number) ? null : number.toString();\n  },\n\n  fromView(value) {\n    if (value === null || value === undefined) {\n      return null;\n    }\n\n    const number = value * 1;\n    return isNaN(number) ? null : number;\n  }\n\n};\n/**\n * An implementation of {@link Accessor} that supports reactivity,\n * change callbacks, attribute reflection, and type conversion for\n * custom elements.\n * @public\n */\n\nexport class AttributeDefinition {\n  /**\n   * Creates an instance of AttributeDefinition.\n   * @param Owner - The class constructor that owns this attribute.\n   * @param name - The name of the property associated with the attribute.\n   * @param attribute - The name of the attribute in HTML.\n   * @param mode - The {@link AttributeMode} that describes the behavior of this attribute.\n   * @param converter - A {@link ValueConverter} that integrates with the property getter/setter\n   * to convert values to and from a DOM string.\n   */\n  constructor(Owner, name) {\n    let attribute = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : name.toLowerCase();\n    let mode = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : \"reflect\";\n    let converter = arguments.length > 4 ? arguments[4] : undefined;\n    this.guards = new Set();\n    this.Owner = Owner;\n    this.name = name;\n    this.attribute = attribute;\n    this.mode = mode;\n    this.converter = converter;\n    this.fieldName = `_${name}`;\n    this.callbackName = `${name}Changed`;\n    this.hasCallback = this.callbackName in Owner.prototype;\n\n    if (mode === \"boolean\" && converter === void 0) {\n      this.converter = booleanConverter;\n    }\n  }\n  /**\n   * Sets the value of the attribute/property on the source element.\n   * @param source - The source element to access.\n   * @param value - The value to set the attribute/property to.\n   */\n\n\n  setValue(source, newValue) {\n    const oldValue = source[this.fieldName];\n    const converter = this.converter;\n\n    if (converter !== void 0) {\n      newValue = converter.fromView(newValue);\n    }\n\n    if (oldValue !== newValue) {\n      source[this.fieldName] = newValue;\n      this.tryReflectToAttribute(source);\n\n      if (this.hasCallback) {\n        source[this.callbackName](oldValue, newValue);\n      }\n\n      source.$fastController.notify(this.name);\n    }\n  }\n  /**\n   * Gets the value of the attribute/property on the source element.\n   * @param source - The source element to access.\n   */\n\n\n  getValue(source) {\n    Observable.track(source, this.name);\n    return source[this.fieldName];\n  }\n  /** @internal */\n\n\n  onAttributeChangedCallback(element, value) {\n    if (this.guards.has(element)) {\n      return;\n    }\n\n    this.guards.add(element);\n    this.setValue(element, value);\n    this.guards.delete(element);\n  }\n\n  tryReflectToAttribute(element) {\n    const mode = this.mode;\n    const guards = this.guards;\n\n    if (guards.has(element) || mode === \"fromView\") {\n      return;\n    }\n\n    DOM.queueUpdate(() => {\n      guards.add(element);\n      const latestValue = element[this.fieldName];\n\n      switch (mode) {\n        case \"reflect\":\n          const converter = this.converter;\n          DOM.setAttribute(element, this.attribute, converter !== void 0 ? converter.toView(latestValue) : latestValue);\n          break;\n\n        case \"boolean\":\n          DOM.setBooleanAttribute(element, this.attribute, latestValue);\n          break;\n      }\n\n      guards.delete(element);\n    });\n  }\n  /**\n   * Collects all attribute definitions associated with the owner.\n   * @param Owner - The class constructor to collect attribute for.\n   * @param attributeLists - Any existing attributes to collect and merge with those associated with the owner.\n   * @internal\n   */\n\n\n  static collect(Owner) {\n    const attributes = [];\n\n    for (var _len = arguments.length, attributeLists = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      attributeLists[_key - 1] = arguments[_key];\n    }\n\n    attributeLists.push(AttributeConfiguration.locate(Owner));\n\n    for (let i = 0, ii = attributeLists.length; i < ii; ++i) {\n      const list = attributeLists[i];\n\n      if (list === void 0) {\n        continue;\n      }\n\n      for (let j = 0, jj = list.length; j < jj; ++j) {\n        const config = list[j];\n\n        if (typeof config === \"string\") {\n          attributes.push(new AttributeDefinition(Owner, config));\n        } else {\n          attributes.push(new AttributeDefinition(Owner, config.property, config.attribute, config.mode, config.converter));\n        }\n      }\n    }\n\n    return attributes;\n  }\n\n}\nexport function attr(configOrTarget, prop) {\n  let config;\n\n  function decorator($target, $prop) {\n    if (arguments.length > 1) {\n      // Non invocation:\n      // - @attr\n      // Invocation with or w/o opts:\n      // - @attr()\n      // - @attr({...opts})\n      config.property = $prop;\n    }\n\n    AttributeConfiguration.locate($target.constructor).push(config);\n  }\n\n  if (arguments.length > 1) {\n    // Non invocation:\n    // - @attr\n    config = {};\n    decorator(configOrTarget, prop);\n    return;\n  } // Invocation with or w/o opts:\n  // - @attr()\n  // - @attr({...opts})\n\n\n  config = configOrTarget === void 0 ? {} : configOrTarget;\n  return decorator;\n}","map":{"version":3,"names":["Observable","DOM","createMetadataLocator","AttributeConfiguration","Object","freeze","locate","booleanConverter","toView","value","fromView","nullableNumberConverter","undefined","number","isNaN","toString","AttributeDefinition","constructor","Owner","name","attribute","toLowerCase","mode","converter","guards","Set","fieldName","callbackName","hasCallback","prototype","setValue","source","newValue","oldValue","tryReflectToAttribute","$fastController","notify","getValue","track","onAttributeChangedCallback","element","has","add","delete","queueUpdate","latestValue","setAttribute","setBooleanAttribute","collect","attributes","attributeLists","push","i","ii","length","list","j","jj","config","property","attr","configOrTarget","prop","decorator","$target","$prop","arguments"],"sources":["/Users/gaborcsardi/works/rig/vscode/webview-ui/node_modules/@microsoft/fast-element/dist/esm/components/attributes.js"],"sourcesContent":["import { Observable } from \"../observation/observable.js\";\nimport { DOM } from \"../dom.js\";\nimport { createMetadataLocator } from \"../platform.js\";\n/**\n * Metadata used to configure a custom attribute's behavior.\n * @public\n */\nexport const AttributeConfiguration = Object.freeze({\n    /**\n     * Locates all attribute configurations associated with a type.\n     */\n    locate: createMetadataLocator(),\n});\n/**\n * A {@link ValueConverter} that converts to and from `boolean` values.\n * @remarks\n * Used automatically when the `boolean` {@link AttributeMode} is selected.\n * @public\n */\nexport const booleanConverter = {\n    toView(value) {\n        return value ? \"true\" : \"false\";\n    },\n    fromView(value) {\n        if (value === null ||\n            value === void 0 ||\n            value === \"false\" ||\n            value === false ||\n            value === 0) {\n            return false;\n        }\n        return true;\n    },\n};\n/**\n * A {@link ValueConverter} that converts to and from `number` values.\n * @remarks\n * This converter allows for nullable numbers, returning `null` if the\n * input was `null`, `undefined`, or `NaN`.\n * @public\n */\nexport const nullableNumberConverter = {\n    toView(value) {\n        if (value === null || value === undefined) {\n            return null;\n        }\n        const number = value * 1;\n        return isNaN(number) ? null : number.toString();\n    },\n    fromView(value) {\n        if (value === null || value === undefined) {\n            return null;\n        }\n        const number = value * 1;\n        return isNaN(number) ? null : number;\n    },\n};\n/**\n * An implementation of {@link Accessor} that supports reactivity,\n * change callbacks, attribute reflection, and type conversion for\n * custom elements.\n * @public\n */\nexport class AttributeDefinition {\n    /**\n     * Creates an instance of AttributeDefinition.\n     * @param Owner - The class constructor that owns this attribute.\n     * @param name - The name of the property associated with the attribute.\n     * @param attribute - The name of the attribute in HTML.\n     * @param mode - The {@link AttributeMode} that describes the behavior of this attribute.\n     * @param converter - A {@link ValueConverter} that integrates with the property getter/setter\n     * to convert values to and from a DOM string.\n     */\n    constructor(Owner, name, attribute = name.toLowerCase(), mode = \"reflect\", converter) {\n        this.guards = new Set();\n        this.Owner = Owner;\n        this.name = name;\n        this.attribute = attribute;\n        this.mode = mode;\n        this.converter = converter;\n        this.fieldName = `_${name}`;\n        this.callbackName = `${name}Changed`;\n        this.hasCallback = this.callbackName in Owner.prototype;\n        if (mode === \"boolean\" && converter === void 0) {\n            this.converter = booleanConverter;\n        }\n    }\n    /**\n     * Sets the value of the attribute/property on the source element.\n     * @param source - The source element to access.\n     * @param value - The value to set the attribute/property to.\n     */\n    setValue(source, newValue) {\n        const oldValue = source[this.fieldName];\n        const converter = this.converter;\n        if (converter !== void 0) {\n            newValue = converter.fromView(newValue);\n        }\n        if (oldValue !== newValue) {\n            source[this.fieldName] = newValue;\n            this.tryReflectToAttribute(source);\n            if (this.hasCallback) {\n                source[this.callbackName](oldValue, newValue);\n            }\n            source.$fastController.notify(this.name);\n        }\n    }\n    /**\n     * Gets the value of the attribute/property on the source element.\n     * @param source - The source element to access.\n     */\n    getValue(source) {\n        Observable.track(source, this.name);\n        return source[this.fieldName];\n    }\n    /** @internal */\n    onAttributeChangedCallback(element, value) {\n        if (this.guards.has(element)) {\n            return;\n        }\n        this.guards.add(element);\n        this.setValue(element, value);\n        this.guards.delete(element);\n    }\n    tryReflectToAttribute(element) {\n        const mode = this.mode;\n        const guards = this.guards;\n        if (guards.has(element) || mode === \"fromView\") {\n            return;\n        }\n        DOM.queueUpdate(() => {\n            guards.add(element);\n            const latestValue = element[this.fieldName];\n            switch (mode) {\n                case \"reflect\":\n                    const converter = this.converter;\n                    DOM.setAttribute(element, this.attribute, converter !== void 0 ? converter.toView(latestValue) : latestValue);\n                    break;\n                case \"boolean\":\n                    DOM.setBooleanAttribute(element, this.attribute, latestValue);\n                    break;\n            }\n            guards.delete(element);\n        });\n    }\n    /**\n     * Collects all attribute definitions associated with the owner.\n     * @param Owner - The class constructor to collect attribute for.\n     * @param attributeLists - Any existing attributes to collect and merge with those associated with the owner.\n     * @internal\n     */\n    static collect(Owner, ...attributeLists) {\n        const attributes = [];\n        attributeLists.push(AttributeConfiguration.locate(Owner));\n        for (let i = 0, ii = attributeLists.length; i < ii; ++i) {\n            const list = attributeLists[i];\n            if (list === void 0) {\n                continue;\n            }\n            for (let j = 0, jj = list.length; j < jj; ++j) {\n                const config = list[j];\n                if (typeof config === \"string\") {\n                    attributes.push(new AttributeDefinition(Owner, config));\n                }\n                else {\n                    attributes.push(new AttributeDefinition(Owner, config.property, config.attribute, config.mode, config.converter));\n                }\n            }\n        }\n        return attributes;\n    }\n}\nexport function attr(configOrTarget, prop) {\n    let config;\n    function decorator($target, $prop) {\n        if (arguments.length > 1) {\n            // Non invocation:\n            // - @attr\n            // Invocation with or w/o opts:\n            // - @attr()\n            // - @attr({...opts})\n            config.property = $prop;\n        }\n        AttributeConfiguration.locate($target.constructor).push(config);\n    }\n    if (arguments.length > 1) {\n        // Non invocation:\n        // - @attr\n        config = {};\n        decorator(configOrTarget, prop);\n        return;\n    }\n    // Invocation with or w/o opts:\n    // - @attr()\n    // - @attr({...opts})\n    config = configOrTarget === void 0 ? {} : configOrTarget;\n    return decorator;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}