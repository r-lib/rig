{"ast":null,"code":"// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\n\n/**\n * Configures a MutationObserver to watch for Visual Studio Code theme changes and\n * applies the current Visual Studio Code theme to the toolkit components.\n */\nexport function initThemeChangeListener(tokenMappings) {\n  window.addEventListener('load', () => {\n    const observer = new MutationObserver(() => {\n      applyCurrentTheme(tokenMappings);\n    });\n    observer.observe(document.body, {\n      attributes: true,\n      attributeFilter: ['class']\n    });\n    applyCurrentTheme(tokenMappings);\n  });\n}\n/**\n * Applies the current Visual Studio Code theme to the toolkit components.\n */\n\nfunction applyCurrentTheme(tokenMappings) {\n  // Get all the styles applied to the <body> tag in the webview HTML\n  // Importantly this includes all the CSS variables associated with the\n  // current Visual Studio Code theme\n  const styles = getComputedStyle(document.body);\n  const body = document.querySelector('body');\n\n  if (body) {\n    const themeKind = body.getAttribute('data-vscode-theme-kind');\n\n    for (const [vscodeTokenName, toolkitToken] of tokenMappings) {\n      let value = styles.getPropertyValue(vscodeTokenName).toString(); // Handle a couple of styling edge cases when a high contrast theme is applied\n\n      if (themeKind === 'vscode-high-contrast') {\n        // Developer note:\n        //\n        // There are a handful of VS Code theme tokens that have no value when a high\n        // contrast theme is applied.\n        //\n        // This is an issue because when no value is set the toolkit tokens will fall\n        // back to their default color values (aka the VS Code dark theme color palette).\n        // This results in the backgrounds of a couple of components having default dark\n        // theme colors––thus breaking the high contrast theme.\n        //\n        // The below code, catches these tokens which have no value and are also background\n        // tokens, then overrides their value to be transparent.\n        if (value.length === 0 && toolkitToken.name.includes('background')) {\n          value = 'transparent';\n        } // Set icon button hover to be transparent in high contrast themes\n\n\n        if (toolkitToken.name === 'button-icon-hover-background') {\n          value = 'transparent';\n        }\n      } else if (themeKind === 'vscode-high-contrast-light') {\n        if (value.length === 0 && toolkitToken.name.includes('background')) {\n          // Set button variant hover backgrounds to correct values based on VS Code core source:\n          // https://github.com/microsoft/vscode/blob/fd0ee4f77e354de10ae591c9e97fe5ad41b398fc/src/vs/platform/theme/common/colorRegistry.ts#L270-L276\n          switch (toolkitToken.name) {\n            case 'button-primary-hover-background':\n              value = '#0F4A85';\n              break;\n\n            case 'button-secondary-hover-background':\n              value = 'transparent';\n              break;\n\n            case 'button-icon-hover-background':\n              value = 'transparent';\n              break;\n          }\n        }\n      } else {\n        // Set contrast-active-border token to be transparent in non-high-contrast themes\n        if (toolkitToken.name === 'contrast-active-border') {\n          value = 'transparent';\n        }\n      }\n\n      toolkitToken.setValueFor(body, value);\n    }\n  }\n}","map":{"version":3,"names":["initThemeChangeListener","tokenMappings","window","addEventListener","observer","MutationObserver","applyCurrentTheme","observe","document","body","attributes","attributeFilter","styles","getComputedStyle","querySelector","themeKind","getAttribute","vscodeTokenName","toolkitToken","value","getPropertyValue","toString","length","name","includes","setValueFor"],"sources":["/Users/gaborcsardi/works/rig/vscode/webview-ui/node_modules/@vscode/webview-ui-toolkit/dist/utilities/theme/applyTheme.js"],"sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\n/**\n * Configures a MutationObserver to watch for Visual Studio Code theme changes and\n * applies the current Visual Studio Code theme to the toolkit components.\n */\nexport function initThemeChangeListener(tokenMappings) {\n    window.addEventListener('load', () => {\n        const observer = new MutationObserver(() => {\n            applyCurrentTheme(tokenMappings);\n        });\n        observer.observe(document.body, {\n            attributes: true,\n            attributeFilter: ['class'],\n        });\n        applyCurrentTheme(tokenMappings);\n    });\n}\n/**\n * Applies the current Visual Studio Code theme to the toolkit components.\n */\nfunction applyCurrentTheme(tokenMappings) {\n    // Get all the styles applied to the <body> tag in the webview HTML\n    // Importantly this includes all the CSS variables associated with the\n    // current Visual Studio Code theme\n    const styles = getComputedStyle(document.body);\n    const body = document.querySelector('body');\n    if (body) {\n        const themeKind = body.getAttribute('data-vscode-theme-kind');\n        for (const [vscodeTokenName, toolkitToken] of tokenMappings) {\n            let value = styles.getPropertyValue(vscodeTokenName).toString();\n            // Handle a couple of styling edge cases when a high contrast theme is applied\n            if (themeKind === 'vscode-high-contrast') {\n                // Developer note:\n                //\n                // There are a handful of VS Code theme tokens that have no value when a high\n                // contrast theme is applied.\n                //\n                // This is an issue because when no value is set the toolkit tokens will fall\n                // back to their default color values (aka the VS Code dark theme color palette).\n                // This results in the backgrounds of a couple of components having default dark\n                // theme colors––thus breaking the high contrast theme.\n                //\n                // The below code, catches these tokens which have no value and are also background\n                // tokens, then overrides their value to be transparent.\n                if (value.length === 0 &&\n                    toolkitToken.name.includes('background')) {\n                    value = 'transparent';\n                }\n                // Set icon button hover to be transparent in high contrast themes\n                if (toolkitToken.name === 'button-icon-hover-background') {\n                    value = 'transparent';\n                }\n            }\n            else if (themeKind === 'vscode-high-contrast-light') {\n                if (value.length === 0 &&\n                    toolkitToken.name.includes('background')) {\n                    // Set button variant hover backgrounds to correct values based on VS Code core source:\n                    // https://github.com/microsoft/vscode/blob/fd0ee4f77e354de10ae591c9e97fe5ad41b398fc/src/vs/platform/theme/common/colorRegistry.ts#L270-L276\n                    switch (toolkitToken.name) {\n                        case 'button-primary-hover-background':\n                            value = '#0F4A85';\n                            break;\n                        case 'button-secondary-hover-background':\n                            value = 'transparent';\n                            break;\n                        case 'button-icon-hover-background':\n                            value = 'transparent';\n                            break;\n                    }\n                }\n            }\n            else {\n                // Set contrast-active-border token to be transparent in non-high-contrast themes\n                if (toolkitToken.name === 'contrast-active-border') {\n                    value = 'transparent';\n                }\n            }\n            toolkitToken.setValueFor(body, value);\n        }\n    }\n}\n"],"mappings":"AAAA;AACA;;AACA;AACA;AACA;AACA;AACA,OAAO,SAASA,uBAAT,CAAiCC,aAAjC,EAAgD;EACnDC,MAAM,CAACC,gBAAP,CAAwB,MAAxB,EAAgC,MAAM;IAClC,MAAMC,QAAQ,GAAG,IAAIC,gBAAJ,CAAqB,MAAM;MACxCC,iBAAiB,CAACL,aAAD,CAAjB;IACH,CAFgB,CAAjB;IAGAG,QAAQ,CAACG,OAAT,CAAiBC,QAAQ,CAACC,IAA1B,EAAgC;MAC5BC,UAAU,EAAE,IADgB;MAE5BC,eAAe,EAAE,CAAC,OAAD;IAFW,CAAhC;IAIAL,iBAAiB,CAACL,aAAD,CAAjB;EACH,CATD;AAUH;AACD;AACA;AACA;;AACA,SAASK,iBAAT,CAA2BL,aAA3B,EAA0C;EACtC;EACA;EACA;EACA,MAAMW,MAAM,GAAGC,gBAAgB,CAACL,QAAQ,CAACC,IAAV,CAA/B;EACA,MAAMA,IAAI,GAAGD,QAAQ,CAACM,aAAT,CAAuB,MAAvB,CAAb;;EACA,IAAIL,IAAJ,EAAU;IACN,MAAMM,SAAS,GAAGN,IAAI,CAACO,YAAL,CAAkB,wBAAlB,CAAlB;;IACA,KAAK,MAAM,CAACC,eAAD,EAAkBC,YAAlB,CAAX,IAA8CjB,aAA9C,EAA6D;MACzD,IAAIkB,KAAK,GAAGP,MAAM,CAACQ,gBAAP,CAAwBH,eAAxB,EAAyCI,QAAzC,EAAZ,CADyD,CAEzD;;MACA,IAAIN,SAAS,KAAK,sBAAlB,EAA0C;QACtC;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,IAAII,KAAK,CAACG,MAAN,KAAiB,CAAjB,IACAJ,YAAY,CAACK,IAAb,CAAkBC,QAAlB,CAA2B,YAA3B,CADJ,EAC8C;UAC1CL,KAAK,GAAG,aAAR;QACH,CAhBqC,CAiBtC;;;QACA,IAAID,YAAY,CAACK,IAAb,KAAsB,8BAA1B,EAA0D;UACtDJ,KAAK,GAAG,aAAR;QACH;MACJ,CArBD,MAsBK,IAAIJ,SAAS,KAAK,4BAAlB,EAAgD;QACjD,IAAII,KAAK,CAACG,MAAN,KAAiB,CAAjB,IACAJ,YAAY,CAACK,IAAb,CAAkBC,QAAlB,CAA2B,YAA3B,CADJ,EAC8C;UAC1C;UACA;UACA,QAAQN,YAAY,CAACK,IAArB;YACI,KAAK,iCAAL;cACIJ,KAAK,GAAG,SAAR;cACA;;YACJ,KAAK,mCAAL;cACIA,KAAK,GAAG,aAAR;cACA;;YACJ,KAAK,8BAAL;cACIA,KAAK,GAAG,aAAR;cACA;UATR;QAWH;MACJ,CAjBI,MAkBA;QACD;QACA,IAAID,YAAY,CAACK,IAAb,KAAsB,wBAA1B,EAAoD;UAChDJ,KAAK,GAAG,aAAR;QACH;MACJ;;MACDD,YAAY,CAACO,WAAb,CAAyBhB,IAAzB,EAA+BU,KAA/B;IACH;EACJ;AACJ"},"metadata":{},"sourceType":"module"}