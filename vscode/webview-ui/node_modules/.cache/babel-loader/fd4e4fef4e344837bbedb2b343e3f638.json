{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { attr, DOM, html, observable, ref, RepeatDirective } from \"@microsoft/fast-element\";\nimport { keyArrowDown, keyArrowLeft, keyArrowRight, keyArrowUp, keyBackspace, keyDelete, keyEnter, keyEscape, uniqueId } from \"@microsoft/fast-web-utilities\";\nimport { FlyoutPosBottom, FlyoutPosBottomFill, FlyoutPosTallest, FlyoutPosTallestFill, FlyoutPosTop, FlyoutPosTopFill } from \"../anchored-region/index.js\";\nimport { PickerMenuOption } from \"./picker-menu-option.js\";\nimport { PickerListItem } from \"./picker-list-item.js\";\nimport { FormAssociatedPicker } from \"./picker.form-associated.js\";\nconst pickerInputTemplate = html`\n    <input\n        slot=\"input-region\"\n        role=\"combobox\"\n        type=\"text\"\n        autocapitalize=\"off\"\n        autocomplete=\"off\"\n        haspopup=\"list\"\n        aria-label=\"${x => x.label}\"\n        aria-labelledby=\"${x => x.labelledBy}\"\n        placeholder=\"${x => x.placeholder}\"\n        ${ref(\"inputElement\")}\n    ></input>\n`;\n/**\n * A Picker Custom HTML Element.  This is an early \"alpha\" version of the component.\n * Developers should expect the api to evolve, breaking changes are possible.\n *\n * @alpha\n */\n\nexport class Picker extends FormAssociatedPicker {\n  constructor() {\n    super(...arguments);\n    /**\n     * Currently selected items. Comma delineated string ie. \"apples,oranges\".\n     *\n     * @alpha\n     * @remarks\n     * HTML Attribute: selection\n     */\n\n    this.selection = \"\";\n    /**\n     * Whether the component should remove an option from the list when it is in the selection\n     *\n     * @alpha\n     * @remarks\n     * HTML Attribute: filter-selected\n     */\n\n    this.filterSelected = true;\n    /**\n     * Whether the component should remove options based on the current query\n     *\n     * @alpha\n     * @remarks\n     * HTML Attribute: filter-query\n     */\n\n    this.filterQuery = true;\n    /**\n     * The text to present to assistive technolgies when no suggestions are available.\n     *\n     * @alpha\n     * @remarks\n     * HTML Attribute: no-suggestions-text\n     */\n\n    this.noSuggestionsText = \"No suggestions available\";\n    /**\n     *  The text to present to assistive technolgies when suggestions are available.\n     *\n     * @alpha\n     * @remarks\n     * HTML Attribute: suggestions-available-text\n     */\n\n    this.suggestionsAvailableText = \"Suggestions available\";\n    /**\n     * The text to present to assistive technologies when suggestions are loading.\n     *\n     * @alpha\n     * @remarks\n     * HTML Attribute: loading-text\n     */\n\n    this.loadingText = \"Loading suggestions\";\n    /**\n     * Controls menu placement\n     *\n     * @alpha\n     * @remarks\n     * HTML Attribute: menu-placement\n     */\n\n    this.menuPlacement = \"bottom-fill\";\n    /**\n     * Whether to display a loading state if the menu is opened.\n     *\n     * @alpha\n     */\n\n    this.showLoading = false;\n    /**\n     *  Current list of options in array form\n     *\n     * @alpha\n     */\n\n    this.optionsList = [];\n    /**\n     *  Current list of filtered options in array form\n     *\n     * @internal\n     */\n\n    this.filteredOptionsList = [];\n    /**\n     *  Indicates if the flyout menu is open or not\n     *\n     * @internal\n     */\n\n    this.flyoutOpen = false;\n    /**\n     *  Index of currently active menu option\n     *\n     * @internal\n     */\n\n    this.menuFocusIndex = -1;\n    /**\n     *  Internal flag to indicate no options available display should be shown.\n     *\n     * @internal\n     */\n\n    this.showNoOptions = false;\n    /**\n     *\n     *\n     * @internal\n     */\n\n    this.selectedItems = [];\n    this.inputElementView = null;\n    /**\n     * Handle input event from input element\n     */\n\n    this.handleTextInput = e => {\n      this.query = this.inputElement.value;\n    };\n    /**\n     * Handle click event from input element\n     */\n\n\n    this.handleInputClick = e => {\n      e.preventDefault();\n      this.toggleFlyout(true);\n    };\n    /**\n     * Sets properties on the anchored region once it is instanciated.\n     */\n\n\n    this.setRegionProps = () => {\n      if (!this.flyoutOpen) {\n        return;\n      }\n\n      if (this.region === null || this.region === undefined) {\n        // TODO: limit this\n        DOM.queueUpdate(this.setRegionProps);\n        return;\n      }\n\n      this.region.anchorElement = this.inputElement;\n    };\n    /**\n     * matches menu placement values with the associated menu config\n     */\n\n\n    this.configLookup = {\n      top: FlyoutPosTop,\n      bottom: FlyoutPosBottom,\n      tallest: FlyoutPosTallest,\n      \"top-fill\": FlyoutPosTopFill,\n      \"bottom-fill\": FlyoutPosBottomFill,\n      \"tallest-fill\": FlyoutPosTallestFill\n    };\n  }\n\n  selectionChanged() {\n    if (this.$fastController.isConnected) {\n      this.handleSelectionChange();\n\n      if (this.proxy instanceof HTMLInputElement) {\n        this.proxy.value = this.selection;\n        this.validate();\n      }\n    }\n  }\n\n  optionsChanged() {\n    this.optionsList = this.options.split(\",\").map(opt => opt.trim()).filter(opt => opt !== \"\");\n  }\n\n  menuPlacementChanged() {\n    if (this.$fastController.isConnected) {\n      this.updateMenuConfig();\n    }\n  }\n\n  showLoadingChanged() {\n    if (this.$fastController.isConnected) {\n      DOM.queueUpdate(() => {\n        this.setFocusedOption(0);\n      });\n    }\n  }\n\n  listItemTemplateChanged() {\n    this.updateListItemTemplate();\n  }\n\n  defaultListItemTemplateChanged() {\n    this.updateListItemTemplate();\n  }\n\n  menuOptionTemplateChanged() {\n    this.updateOptionTemplate();\n  }\n\n  defaultMenuOptionTemplateChanged() {\n    this.updateOptionTemplate();\n  }\n\n  optionsListChanged() {\n    this.updateFilteredOptions();\n  }\n\n  queryChanged() {\n    if (this.$fastController.isConnected) {\n      if (this.inputElement.value !== this.query) {\n        this.inputElement.value = this.query;\n      }\n\n      this.updateFilteredOptions();\n      this.$emit(\"querychange\", {\n        bubbles: false\n      });\n    }\n  }\n\n  filteredOptionsListChanged() {\n    if (this.$fastController.isConnected) {\n      this.showNoOptions = this.filteredOptionsList.length === 0 && this.menuElement.querySelectorAll('[role=\"listitem\"]').length === 0;\n      this.setFocusedOption(this.showNoOptions ? -1 : 0);\n    }\n  }\n\n  flyoutOpenChanged() {\n    if (this.flyoutOpen) {\n      DOM.queueUpdate(this.setRegionProps);\n      this.$emit(\"menuopening\", {\n        bubbles: false\n      });\n    } else {\n      this.$emit(\"menuclosing\", {\n        bubbles: false\n      });\n    }\n  }\n\n  showNoOptionsChanged() {\n    if (this.$fastController.isConnected) {\n      DOM.queueUpdate(() => {\n        this.setFocusedOption(0);\n      });\n    }\n  }\n  /**\n   * @internal\n   */\n\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.listElement = document.createElement(this.selectedListTag);\n    this.appendChild(this.listElement);\n    this.itemsPlaceholderElement = document.createComment(\"\");\n    this.listElement.append(this.itemsPlaceholderElement);\n    this.inputElementView = pickerInputTemplate.render(this, this.listElement);\n    const match = this.menuTag.toUpperCase();\n    this.menuElement = Array.from(this.children).find(element => {\n      return element.tagName === match;\n    });\n\n    if (this.menuElement === undefined) {\n      this.menuElement = document.createElement(this.menuTag);\n      this.appendChild(this.menuElement);\n    }\n\n    if (this.menuElement.id === \"\") {\n      this.menuElement.id = uniqueId(\"listbox-\");\n    }\n\n    this.menuId = this.menuElement.id;\n    this.optionsPlaceholder = document.createComment(\"\");\n    this.menuElement.append(this.optionsPlaceholder);\n    this.updateMenuConfig();\n    DOM.queueUpdate(() => this.initialize());\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    this.toggleFlyout(false);\n    this.inputElement.removeEventListener(\"input\", this.handleTextInput);\n    this.inputElement.removeEventListener(\"click\", this.handleInputClick);\n\n    if (this.inputElementView !== null) {\n      this.inputElementView.dispose();\n      this.inputElementView = null;\n    }\n  }\n  /**\n   * Move focus to the input element\n   * @public\n   */\n\n\n  focus() {\n    this.inputElement.focus();\n  }\n  /**\n   * Initialize the component.  This is delayed a frame to ensure children are connected as well.\n   */\n\n\n  initialize() {\n    this.updateListItemTemplate();\n    this.updateOptionTemplate();\n    this.itemsRepeatBehavior = new RepeatDirective(x => x.selectedItems, x => x.activeListItemTemplate, {\n      positioning: true\n    }).createBehavior(this.itemsPlaceholderElement);\n    this.inputElement.addEventListener(\"input\", this.handleTextInput);\n    this.inputElement.addEventListener(\"click\", this.handleInputClick);\n    /* eslint-disable-next-line @typescript-eslint/no-non-null-assertion */\n\n    this.$fastController.addBehaviors([this.itemsRepeatBehavior]);\n    this.menuElement.suggestionsAvailableText = this.suggestionsAvailableText;\n    this.menuElement.addEventListener(\"optionsupdated\", this.handleMenuOptionsUpdated);\n    this.optionsRepeatBehavior = new RepeatDirective(x => x.filteredOptionsList, x => x.activeMenuOptionTemplate, {\n      positioning: true\n    }).createBehavior(this.optionsPlaceholder);\n    /* eslint-disable-next-line @typescript-eslint/no-non-null-assertion */\n\n    this.$fastController.addBehaviors([this.optionsRepeatBehavior]);\n    this.handleSelectionChange();\n  }\n  /**\n   * Toggles the menu flyout\n   */\n\n\n  toggleFlyout(open) {\n    if (this.flyoutOpen === open) {\n      return;\n    }\n\n    if (open && document.activeElement === this.inputElement) {\n      this.flyoutOpen = open;\n      DOM.queueUpdate(() => {\n        if (this.menuElement !== undefined) {\n          this.setFocusedOption(0);\n        } else {\n          this.disableMenu();\n        }\n      });\n      return;\n    }\n\n    this.flyoutOpen = false;\n    this.disableMenu();\n    return;\n  }\n  /**\n   * Handle the menu options updated event from the child menu\n   */\n\n\n  handleMenuOptionsUpdated(e) {\n    e.preventDefault();\n\n    if (this.flyoutOpen) {\n      this.setFocusedOption(0);\n    }\n  }\n  /**\n   * Handle key down events.\n   */\n\n\n  handleKeyDown(e) {\n    if (e.defaultPrevented) {\n      return false;\n    }\n\n    switch (e.key) {\n      // TODO: what should \"home\" and \"end\" keys do, exactly?\n      //\n      // case keyHome: {\n      //     if (!this.flyoutOpen) {\n      //         this.toggleFlyout(true);\n      //     } else {\n      //         if (this.menuElement.optionElements.length > 0) {\n      //             this.setFocusedOption(0);\n      //         }\n      //     }\n      //     return false;\n      // }\n      // case keyEnd: {\n      //     if (!this.flyoutOpen) {\n      //         this.toggleFlyout(true);\n      //     } else {\n      //         if (this.menuElement.optionElements.length > 0) {\n      //             this.toggleFlyout(true);\n      //             this.setFocusedOption(this.menuElement.optionElements.length - 1);\n      //         }\n      //     }\n      //     return false;\n      // }\n      case keyArrowDown:\n        {\n          if (!this.flyoutOpen) {\n            this.toggleFlyout(true);\n          } else {\n            const nextFocusOptionIndex = this.flyoutOpen ? Math.min(this.menuFocusIndex + 1, this.menuElement.optionElements.length - 1) : 0;\n            this.setFocusedOption(nextFocusOptionIndex);\n          }\n\n          return false;\n        }\n\n      case keyArrowUp:\n        {\n          if (!this.flyoutOpen) {\n            this.toggleFlyout(true);\n          } else {\n            const previousFocusOptionIndex = this.flyoutOpen ? Math.max(this.menuFocusIndex - 1, 0) : 0;\n            this.setFocusedOption(previousFocusOptionIndex);\n          }\n\n          return false;\n        }\n\n      case keyEscape:\n        {\n          this.toggleFlyout(false);\n          return false;\n        }\n\n      case keyEnter:\n        {\n          if (this.menuFocusIndex !== -1 && this.menuElement.optionElements.length > this.menuFocusIndex) {\n            this.menuElement.optionElements[this.menuFocusIndex].click();\n          }\n\n          return false;\n        }\n\n      case keyArrowRight:\n        {\n          if (document.activeElement !== this.inputElement) {\n            this.incrementFocusedItem(1);\n            return false;\n          } // don't block if arrow keys moving caret in input element\n\n\n          return true;\n        }\n\n      case keyArrowLeft:\n        {\n          if (this.inputElement.selectionStart === 0) {\n            this.incrementFocusedItem(-1);\n            return false;\n          } // don't block if arrow keys moving caret in input element\n\n\n          return true;\n        }\n\n      case keyDelete:\n      case keyBackspace:\n        {\n          if (document.activeElement === null) {\n            return true;\n          }\n\n          if (document.activeElement === this.inputElement) {\n            if (this.inputElement.selectionStart === 0) {\n              this.selection = this.selectedItems.slice(0, this.selectedItems.length - 1).toString();\n              this.toggleFlyout(false);\n              return false;\n            } // let text deletion proceed\n\n\n            return true;\n          }\n\n          const selectedItems = Array.from(this.listElement.children);\n          const currentFocusedItemIndex = selectedItems.indexOf(document.activeElement);\n\n          if (currentFocusedItemIndex > -1) {\n            // delete currently focused item\n            this.selection = this.selectedItems.splice(currentFocusedItemIndex, 1).toString();\n            DOM.queueUpdate(() => {\n              selectedItems[Math.min(selectedItems.length, currentFocusedItemIndex)].focus();\n            });\n            return false;\n          }\n\n          return true;\n        }\n    }\n\n    this.toggleFlyout(true);\n    return true;\n  }\n  /**\n   * Handle focus in events.\n   */\n\n\n  handleFocusIn(e) {\n    return false;\n  }\n  /**\n   * Handle focus out events.\n   */\n\n\n  handleFocusOut(e) {\n    if (this.menuElement === undefined || !this.menuElement.contains(e.relatedTarget)) {\n      this.toggleFlyout(false);\n    }\n\n    return false;\n  }\n  /**\n   * The list of selected items has changed\n   */\n\n\n  handleSelectionChange() {\n    if (this.selectedItems.toString() === this.selection) {\n      return;\n    }\n\n    this.selectedItems = this.selection === \"\" ? [] : this.selection.split(\",\");\n    this.updateFilteredOptions();\n    DOM.queueUpdate(() => {\n      this.checkMaxItems();\n    });\n    this.$emit(\"selectionchange\", {\n      bubbles: false\n    });\n  }\n  /**\n   * Anchored region is loaded, menu and options exist in the DOM.\n   */\n\n\n  handleRegionLoaded(e) {\n    DOM.queueUpdate(() => {\n      this.setFocusedOption(0);\n      this.$emit(\"menuloaded\", {\n        bubbles: false\n      });\n    });\n  }\n  /**\n   * Checks if the maximum number of items has been chosen and updates the ui.\n   */\n\n\n  checkMaxItems() {\n    if (this.inputElement === undefined) {\n      return;\n    }\n\n    if (this.maxSelected !== undefined && this.selectedItems.length >= this.maxSelected) {\n      if (document.activeElement === this.inputElement) {\n        const selectedItemInstances = Array.from(this.listElement.querySelectorAll(\"[role='listitem']\"));\n        selectedItemInstances[selectedItemInstances.length - 1].focus();\n      }\n\n      this.inputElement.hidden = true;\n    } else {\n      this.inputElement.hidden = false;\n    }\n  }\n  /**\n   * A list item has been invoked.\n   */\n\n\n  handleItemInvoke(e) {\n    if (e.defaultPrevented) {\n      return false;\n    }\n\n    if (e.target instanceof PickerListItem) {\n      const listItems = Array.from(this.listElement.querySelectorAll(\"[role='listitem']\"));\n      const itemIndex = listItems.indexOf(e.target);\n\n      if (itemIndex !== -1) {\n        const newSelection = this.selectedItems.slice();\n        newSelection.splice(itemIndex, 1);\n        this.selection = newSelection.toString();\n        DOM.queueUpdate(() => this.incrementFocusedItem(0));\n      }\n\n      return false;\n    }\n\n    return true;\n  }\n  /**\n   * A menu option has been invoked.\n   */\n\n\n  handleOptionInvoke(e) {\n    if (e.defaultPrevented) {\n      return false;\n    }\n\n    if (e.target instanceof PickerMenuOption) {\n      if (e.target.value !== undefined) {\n        this.selection = `${this.selection}${this.selection === \"\" ? \"\" : \",\"}${e.target.value}`;\n      }\n\n      this.inputElement.value = \"\";\n      this.query = \"\";\n      this.inputElement.focus();\n      this.toggleFlyout(false);\n      return false;\n    } // const value: string = (e.target as PickerMenuOption).value;\n\n\n    return true;\n  }\n  /**\n   * Increments the focused list item by the specified amount\n   */\n\n\n  incrementFocusedItem(increment) {\n    if (this.selectedItems.length === 0) {\n      this.inputElement.focus();\n      return;\n    }\n\n    const selectedItemsAsElements = Array.from(this.listElement.querySelectorAll(\"[role='listitem']\"));\n\n    if (document.activeElement !== null) {\n      let currentFocusedItemIndex = selectedItemsAsElements.indexOf(document.activeElement);\n\n      if (currentFocusedItemIndex === -1) {\n        // use the input element\n        currentFocusedItemIndex = selectedItemsAsElements.length;\n      }\n\n      const newFocusedItemIndex = Math.min(selectedItemsAsElements.length, Math.max(0, currentFocusedItemIndex + increment));\n\n      if (newFocusedItemIndex === selectedItemsAsElements.length) {\n        if (this.maxSelected !== undefined && this.selectedItems.length >= this.maxSelected) {\n          selectedItemsAsElements[newFocusedItemIndex - 1].focus();\n        } else {\n          this.inputElement.focus();\n        }\n      } else {\n        selectedItemsAsElements[newFocusedItemIndex].focus();\n      }\n    }\n  }\n  /**\n   * Disables the menu. Note that the menu can be open, just doens't have any valid options on display.\n   */\n\n\n  disableMenu() {\n    var _a, _b, _c;\n\n    this.menuFocusIndex = -1;\n    this.menuFocusOptionId = undefined;\n    (_a = this.inputElement) === null || _a === void 0 ? void 0 : _a.removeAttribute(\"aria-activedescendant\");\n    (_b = this.inputElement) === null || _b === void 0 ? void 0 : _b.removeAttribute(\"aria-owns\");\n    (_c = this.inputElement) === null || _c === void 0 ? void 0 : _c.removeAttribute(\"aria-expanded\");\n  }\n  /**\n   * Sets the currently focused menu option by index\n   */\n\n\n  setFocusedOption(optionIndex) {\n    if (!this.flyoutOpen || optionIndex === -1 || this.showNoOptions || this.showLoading) {\n      this.disableMenu();\n      return;\n    }\n\n    if (this.menuElement.optionElements.length === 0) {\n      return;\n    }\n\n    this.menuElement.optionElements.forEach(element => {\n      element.setAttribute(\"aria-selected\", \"false\");\n    });\n    this.menuFocusIndex = optionIndex;\n\n    if (this.menuFocusIndex > this.menuElement.optionElements.length - 1) {\n      this.menuFocusIndex = this.menuElement.optionElements.length - 1;\n    }\n\n    this.menuFocusOptionId = this.menuElement.optionElements[this.menuFocusIndex].id;\n    this.inputElement.setAttribute(\"aria-owns\", this.menuId);\n    this.inputElement.setAttribute(\"aria-expanded\", \"true\");\n    this.inputElement.setAttribute(\"aria-activedescendant\", this.menuFocusOptionId);\n    const focusedOption = this.menuElement.optionElements[this.menuFocusIndex];\n    focusedOption.setAttribute(\"aria-selected\", \"true\");\n    this.menuElement.scrollTo(0, focusedOption.offsetTop);\n  }\n  /**\n   * Updates the template used for the list item repeat behavior\n   */\n\n\n  updateListItemTemplate() {\n    var _a;\n\n    this.activeListItemTemplate = (_a = this.listItemTemplate) !== null && _a !== void 0 ? _a : this.defaultListItemTemplate;\n  }\n  /**\n   * Updates the template used for the menu option repeat behavior\n   */\n\n\n  updateOptionTemplate() {\n    var _a;\n\n    this.activeMenuOptionTemplate = (_a = this.menuOptionTemplate) !== null && _a !== void 0 ? _a : this.defaultMenuOptionTemplate;\n  }\n  /**\n   * Updates the filtered options array\n   */\n\n\n  updateFilteredOptions() {\n    this.filteredOptionsList = this.optionsList.slice(0);\n\n    if (this.filterSelected) {\n      this.filteredOptionsList = this.filteredOptionsList.filter(el => this.selectedItems.indexOf(el) === -1);\n    }\n\n    if (this.filterQuery && this.query !== \"\" && this.query !== undefined) {\n      this.filteredOptionsList = this.filteredOptionsList.filter(el => el.indexOf(this.query) !== -1);\n    }\n  }\n  /**\n   * Updates the menu configuration\n   */\n\n\n  updateMenuConfig() {\n    let newConfig = this.configLookup[this.menuPlacement];\n\n    if (newConfig === null) {\n      newConfig = FlyoutPosBottomFill;\n    }\n\n    this.menuConfig = Object.assign(Object.assign({}, newConfig), {\n      autoUpdateMode: \"auto\",\n      fixedPlacement: true,\n      horizontalViewportLock: false,\n      verticalViewportLock: false\n    });\n  }\n\n}\n\n__decorate([attr({\n  attribute: \"selection\"\n})], Picker.prototype, \"selection\", void 0);\n\n__decorate([attr({\n  attribute: \"options\"\n})], Picker.prototype, \"options\", void 0);\n\n__decorate([attr({\n  attribute: \"filter-selected\",\n  mode: \"boolean\"\n})], Picker.prototype, \"filterSelected\", void 0);\n\n__decorate([attr({\n  attribute: \"filter-query\",\n  mode: \"boolean\"\n})], Picker.prototype, \"filterQuery\", void 0);\n\n__decorate([attr({\n  attribute: \"max-selected\"\n})], Picker.prototype, \"maxSelected\", void 0);\n\n__decorate([attr({\n  attribute: \"no-suggestions-text\"\n})], Picker.prototype, \"noSuggestionsText\", void 0);\n\n__decorate([attr({\n  attribute: \"suggestions-available-text\"\n})], Picker.prototype, \"suggestionsAvailableText\", void 0);\n\n__decorate([attr({\n  attribute: \"loading-text\"\n})], Picker.prototype, \"loadingText\", void 0);\n\n__decorate([attr({\n  attribute: \"label\"\n})], Picker.prototype, \"label\", void 0);\n\n__decorate([attr({\n  attribute: \"labelledby\"\n})], Picker.prototype, \"labelledBy\", void 0);\n\n__decorate([attr({\n  attribute: \"placeholder\"\n})], Picker.prototype, \"placeholder\", void 0);\n\n__decorate([attr({\n  attribute: \"menu-placement\"\n})], Picker.prototype, \"menuPlacement\", void 0);\n\n__decorate([observable], Picker.prototype, \"showLoading\", void 0);\n\n__decorate([observable], Picker.prototype, \"listItemTemplate\", void 0);\n\n__decorate([observable], Picker.prototype, \"defaultListItemTemplate\", void 0);\n\n__decorate([observable], Picker.prototype, \"activeListItemTemplate\", void 0);\n\n__decorate([observable], Picker.prototype, \"menuOptionTemplate\", void 0);\n\n__decorate([observable], Picker.prototype, \"defaultMenuOptionTemplate\", void 0);\n\n__decorate([observable], Picker.prototype, \"activeMenuOptionTemplate\", void 0);\n\n__decorate([observable], Picker.prototype, \"listItemContentsTemplate\", void 0);\n\n__decorate([observable], Picker.prototype, \"menuOptionContentsTemplate\", void 0);\n\n__decorate([observable], Picker.prototype, \"optionsList\", void 0);\n\n__decorate([observable], Picker.prototype, \"query\", void 0);\n\n__decorate([observable], Picker.prototype, \"filteredOptionsList\", void 0);\n\n__decorate([observable], Picker.prototype, \"flyoutOpen\", void 0);\n\n__decorate([observable], Picker.prototype, \"menuId\", void 0);\n\n__decorate([observable], Picker.prototype, \"selectedListTag\", void 0);\n\n__decorate([observable], Picker.prototype, \"menuTag\", void 0);\n\n__decorate([observable], Picker.prototype, \"menuFocusIndex\", void 0);\n\n__decorate([observable], Picker.prototype, \"menuFocusOptionId\", void 0);\n\n__decorate([observable], Picker.prototype, \"showNoOptions\", void 0);\n\n__decorate([observable], Picker.prototype, \"menuConfig\", void 0);\n\n__decorate([observable], Picker.prototype, \"selectedItems\", void 0);","map":{"version":3,"names":["__decorate","attr","DOM","html","observable","ref","RepeatDirective","keyArrowDown","keyArrowLeft","keyArrowRight","keyArrowUp","keyBackspace","keyDelete","keyEnter","keyEscape","uniqueId","FlyoutPosBottom","FlyoutPosBottomFill","FlyoutPosTallest","FlyoutPosTallestFill","FlyoutPosTop","FlyoutPosTopFill","PickerMenuOption","PickerListItem","FormAssociatedPicker","pickerInputTemplate","x","label","labelledBy","placeholder","Picker","constructor","arguments","selection","filterSelected","filterQuery","noSuggestionsText","suggestionsAvailableText","loadingText","menuPlacement","showLoading","optionsList","filteredOptionsList","flyoutOpen","menuFocusIndex","showNoOptions","selectedItems","inputElementView","handleTextInput","e","query","inputElement","value","handleInputClick","preventDefault","toggleFlyout","setRegionProps","region","undefined","queueUpdate","anchorElement","configLookup","top","bottom","tallest","selectionChanged","$fastController","isConnected","handleSelectionChange","proxy","HTMLInputElement","validate","optionsChanged","options","split","map","opt","trim","filter","menuPlacementChanged","updateMenuConfig","showLoadingChanged","setFocusedOption","listItemTemplateChanged","updateListItemTemplate","defaultListItemTemplateChanged","menuOptionTemplateChanged","updateOptionTemplate","defaultMenuOptionTemplateChanged","optionsListChanged","updateFilteredOptions","queryChanged","$emit","bubbles","filteredOptionsListChanged","length","menuElement","querySelectorAll","flyoutOpenChanged","showNoOptionsChanged","connectedCallback","listElement","document","createElement","selectedListTag","appendChild","itemsPlaceholderElement","createComment","append","render","match","menuTag","toUpperCase","Array","from","children","find","element","tagName","id","menuId","optionsPlaceholder","initialize","disconnectedCallback","removeEventListener","dispose","focus","itemsRepeatBehavior","activeListItemTemplate","positioning","createBehavior","addEventListener","addBehaviors","handleMenuOptionsUpdated","optionsRepeatBehavior","activeMenuOptionTemplate","open","activeElement","disableMenu","handleKeyDown","defaultPrevented","key","nextFocusOptionIndex","Math","min","optionElements","previousFocusOptionIndex","max","click","incrementFocusedItem","selectionStart","slice","toString","currentFocusedItemIndex","indexOf","splice","handleFocusIn","handleFocusOut","contains","relatedTarget","checkMaxItems","handleRegionLoaded","maxSelected","selectedItemInstances","hidden","handleItemInvoke","target","listItems","itemIndex","newSelection","handleOptionInvoke","increment","selectedItemsAsElements","newFocusedItemIndex","_a","_b","_c","menuFocusOptionId","removeAttribute","optionIndex","forEach","setAttribute","focusedOption","scrollTo","offsetTop","listItemTemplate","defaultListItemTemplate","menuOptionTemplate","defaultMenuOptionTemplate","el","newConfig","menuConfig","Object","assign","autoUpdateMode","fixedPlacement","horizontalViewportLock","verticalViewportLock","attribute","prototype","mode"],"sources":["/Users/gaborcsardi/works/rig/vscode/webview-ui/node_modules/@microsoft/fast-foundation/dist/esm/picker/picker.js"],"sourcesContent":["import { __decorate } from \"tslib\";\nimport { attr, DOM, html, observable, ref, RepeatDirective, } from \"@microsoft/fast-element\";\nimport { keyArrowDown, keyArrowLeft, keyArrowRight, keyArrowUp, keyBackspace, keyDelete, keyEnter, keyEscape, uniqueId, } from \"@microsoft/fast-web-utilities\";\nimport { FlyoutPosBottom, FlyoutPosBottomFill, FlyoutPosTallest, FlyoutPosTallestFill, FlyoutPosTop, FlyoutPosTopFill, } from \"../anchored-region/index.js\";\nimport { PickerMenuOption } from \"./picker-menu-option.js\";\nimport { PickerListItem } from \"./picker-list-item.js\";\nimport { FormAssociatedPicker } from \"./picker.form-associated.js\";\nconst pickerInputTemplate = html `\n    <input\n        slot=\"input-region\"\n        role=\"combobox\"\n        type=\"text\"\n        autocapitalize=\"off\"\n        autocomplete=\"off\"\n        haspopup=\"list\"\n        aria-label=\"${x => x.label}\"\n        aria-labelledby=\"${x => x.labelledBy}\"\n        placeholder=\"${x => x.placeholder}\"\n        ${ref(\"inputElement\")}\n    ></input>\n`;\n/**\n * A Picker Custom HTML Element.  This is an early \"alpha\" version of the component.\n * Developers should expect the api to evolve, breaking changes are possible.\n *\n * @alpha\n */\nexport class Picker extends FormAssociatedPicker {\n    constructor() {\n        super(...arguments);\n        /**\n         * Currently selected items. Comma delineated string ie. \"apples,oranges\".\n         *\n         * @alpha\n         * @remarks\n         * HTML Attribute: selection\n         */\n        this.selection = \"\";\n        /**\n         * Whether the component should remove an option from the list when it is in the selection\n         *\n         * @alpha\n         * @remarks\n         * HTML Attribute: filter-selected\n         */\n        this.filterSelected = true;\n        /**\n         * Whether the component should remove options based on the current query\n         *\n         * @alpha\n         * @remarks\n         * HTML Attribute: filter-query\n         */\n        this.filterQuery = true;\n        /**\n         * The text to present to assistive technolgies when no suggestions are available.\n         *\n         * @alpha\n         * @remarks\n         * HTML Attribute: no-suggestions-text\n         */\n        this.noSuggestionsText = \"No suggestions available\";\n        /**\n         *  The text to present to assistive technolgies when suggestions are available.\n         *\n         * @alpha\n         * @remarks\n         * HTML Attribute: suggestions-available-text\n         */\n        this.suggestionsAvailableText = \"Suggestions available\";\n        /**\n         * The text to present to assistive technologies when suggestions are loading.\n         *\n         * @alpha\n         * @remarks\n         * HTML Attribute: loading-text\n         */\n        this.loadingText = \"Loading suggestions\";\n        /**\n         * Controls menu placement\n         *\n         * @alpha\n         * @remarks\n         * HTML Attribute: menu-placement\n         */\n        this.menuPlacement = \"bottom-fill\";\n        /**\n         * Whether to display a loading state if the menu is opened.\n         *\n         * @alpha\n         */\n        this.showLoading = false;\n        /**\n         *  Current list of options in array form\n         *\n         * @alpha\n         */\n        this.optionsList = [];\n        /**\n         *  Current list of filtered options in array form\n         *\n         * @internal\n         */\n        this.filteredOptionsList = [];\n        /**\n         *  Indicates if the flyout menu is open or not\n         *\n         * @internal\n         */\n        this.flyoutOpen = false;\n        /**\n         *  Index of currently active menu option\n         *\n         * @internal\n         */\n        this.menuFocusIndex = -1;\n        /**\n         *  Internal flag to indicate no options available display should be shown.\n         *\n         * @internal\n         */\n        this.showNoOptions = false;\n        /**\n         *\n         *\n         * @internal\n         */\n        this.selectedItems = [];\n        this.inputElementView = null;\n        /**\n         * Handle input event from input element\n         */\n        this.handleTextInput = (e) => {\n            this.query = this.inputElement.value;\n        };\n        /**\n         * Handle click event from input element\n         */\n        this.handleInputClick = (e) => {\n            e.preventDefault();\n            this.toggleFlyout(true);\n        };\n        /**\n         * Sets properties on the anchored region once it is instanciated.\n         */\n        this.setRegionProps = () => {\n            if (!this.flyoutOpen) {\n                return;\n            }\n            if (this.region === null || this.region === undefined) {\n                // TODO: limit this\n                DOM.queueUpdate(this.setRegionProps);\n                return;\n            }\n            this.region.anchorElement = this.inputElement;\n        };\n        /**\n         * matches menu placement values with the associated menu config\n         */\n        this.configLookup = {\n            top: FlyoutPosTop,\n            bottom: FlyoutPosBottom,\n            tallest: FlyoutPosTallest,\n            \"top-fill\": FlyoutPosTopFill,\n            \"bottom-fill\": FlyoutPosBottomFill,\n            \"tallest-fill\": FlyoutPosTallestFill,\n        };\n    }\n    selectionChanged() {\n        if (this.$fastController.isConnected) {\n            this.handleSelectionChange();\n            if (this.proxy instanceof HTMLInputElement) {\n                this.proxy.value = this.selection;\n                this.validate();\n            }\n        }\n    }\n    optionsChanged() {\n        this.optionsList = this.options\n            .split(\",\")\n            .map(opt => opt.trim())\n            .filter(opt => opt !== \"\");\n    }\n    menuPlacementChanged() {\n        if (this.$fastController.isConnected) {\n            this.updateMenuConfig();\n        }\n    }\n    showLoadingChanged() {\n        if (this.$fastController.isConnected) {\n            DOM.queueUpdate(() => {\n                this.setFocusedOption(0);\n            });\n        }\n    }\n    listItemTemplateChanged() {\n        this.updateListItemTemplate();\n    }\n    defaultListItemTemplateChanged() {\n        this.updateListItemTemplate();\n    }\n    menuOptionTemplateChanged() {\n        this.updateOptionTemplate();\n    }\n    defaultMenuOptionTemplateChanged() {\n        this.updateOptionTemplate();\n    }\n    optionsListChanged() {\n        this.updateFilteredOptions();\n    }\n    queryChanged() {\n        if (this.$fastController.isConnected) {\n            if (this.inputElement.value !== this.query) {\n                this.inputElement.value = this.query;\n            }\n            this.updateFilteredOptions();\n            this.$emit(\"querychange\", { bubbles: false });\n        }\n    }\n    filteredOptionsListChanged() {\n        if (this.$fastController.isConnected) {\n            this.showNoOptions =\n                this.filteredOptionsList.length === 0 &&\n                    this.menuElement.querySelectorAll('[role=\"listitem\"]').length === 0;\n            this.setFocusedOption(this.showNoOptions ? -1 : 0);\n        }\n    }\n    flyoutOpenChanged() {\n        if (this.flyoutOpen) {\n            DOM.queueUpdate(this.setRegionProps);\n            this.$emit(\"menuopening\", { bubbles: false });\n        }\n        else {\n            this.$emit(\"menuclosing\", { bubbles: false });\n        }\n    }\n    showNoOptionsChanged() {\n        if (this.$fastController.isConnected) {\n            DOM.queueUpdate(() => {\n                this.setFocusedOption(0);\n            });\n        }\n    }\n    /**\n     * @internal\n     */\n    connectedCallback() {\n        super.connectedCallback();\n        this.listElement = document.createElement(this.selectedListTag);\n        this.appendChild(this.listElement);\n        this.itemsPlaceholderElement = document.createComment(\"\");\n        this.listElement.append(this.itemsPlaceholderElement);\n        this.inputElementView = pickerInputTemplate.render(this, this.listElement);\n        const match = this.menuTag.toUpperCase();\n        this.menuElement = Array.from(this.children).find((element) => {\n            return element.tagName === match;\n        });\n        if (this.menuElement === undefined) {\n            this.menuElement = document.createElement(this.menuTag);\n            this.appendChild(this.menuElement);\n        }\n        if (this.menuElement.id === \"\") {\n            this.menuElement.id = uniqueId(\"listbox-\");\n        }\n        this.menuId = this.menuElement.id;\n        this.optionsPlaceholder = document.createComment(\"\");\n        this.menuElement.append(this.optionsPlaceholder);\n        this.updateMenuConfig();\n        DOM.queueUpdate(() => this.initialize());\n    }\n    disconnectedCallback() {\n        super.disconnectedCallback();\n        this.toggleFlyout(false);\n        this.inputElement.removeEventListener(\"input\", this.handleTextInput);\n        this.inputElement.removeEventListener(\"click\", this.handleInputClick);\n        if (this.inputElementView !== null) {\n            this.inputElementView.dispose();\n            this.inputElementView = null;\n        }\n    }\n    /**\n     * Move focus to the input element\n     * @public\n     */\n    focus() {\n        this.inputElement.focus();\n    }\n    /**\n     * Initialize the component.  This is delayed a frame to ensure children are connected as well.\n     */\n    initialize() {\n        this.updateListItemTemplate();\n        this.updateOptionTemplate();\n        this.itemsRepeatBehavior = new RepeatDirective(x => x.selectedItems, x => x.activeListItemTemplate, { positioning: true }).createBehavior(this.itemsPlaceholderElement);\n        this.inputElement.addEventListener(\"input\", this.handleTextInput);\n        this.inputElement.addEventListener(\"click\", this.handleInputClick);\n        /* eslint-disable-next-line @typescript-eslint/no-non-null-assertion */\n        this.$fastController.addBehaviors([this.itemsRepeatBehavior]);\n        this.menuElement.suggestionsAvailableText = this.suggestionsAvailableText;\n        this.menuElement.addEventListener(\"optionsupdated\", this.handleMenuOptionsUpdated);\n        this.optionsRepeatBehavior = new RepeatDirective(x => x.filteredOptionsList, x => x.activeMenuOptionTemplate, { positioning: true }).createBehavior(this.optionsPlaceholder);\n        /* eslint-disable-next-line @typescript-eslint/no-non-null-assertion */\n        this.$fastController.addBehaviors([this.optionsRepeatBehavior]);\n        this.handleSelectionChange();\n    }\n    /**\n     * Toggles the menu flyout\n     */\n    toggleFlyout(open) {\n        if (this.flyoutOpen === open) {\n            return;\n        }\n        if (open && document.activeElement === this.inputElement) {\n            this.flyoutOpen = open;\n            DOM.queueUpdate(() => {\n                if (this.menuElement !== undefined) {\n                    this.setFocusedOption(0);\n                }\n                else {\n                    this.disableMenu();\n                }\n            });\n            return;\n        }\n        this.flyoutOpen = false;\n        this.disableMenu();\n        return;\n    }\n    /**\n     * Handle the menu options updated event from the child menu\n     */\n    handleMenuOptionsUpdated(e) {\n        e.preventDefault();\n        if (this.flyoutOpen) {\n            this.setFocusedOption(0);\n        }\n    }\n    /**\n     * Handle key down events.\n     */\n    handleKeyDown(e) {\n        if (e.defaultPrevented) {\n            return false;\n        }\n        switch (e.key) {\n            // TODO: what should \"home\" and \"end\" keys do, exactly?\n            //\n            // case keyHome: {\n            //     if (!this.flyoutOpen) {\n            //         this.toggleFlyout(true);\n            //     } else {\n            //         if (this.menuElement.optionElements.length > 0) {\n            //             this.setFocusedOption(0);\n            //         }\n            //     }\n            //     return false;\n            // }\n            // case keyEnd: {\n            //     if (!this.flyoutOpen) {\n            //         this.toggleFlyout(true);\n            //     } else {\n            //         if (this.menuElement.optionElements.length > 0) {\n            //             this.toggleFlyout(true);\n            //             this.setFocusedOption(this.menuElement.optionElements.length - 1);\n            //         }\n            //     }\n            //     return false;\n            // }\n            case keyArrowDown: {\n                if (!this.flyoutOpen) {\n                    this.toggleFlyout(true);\n                }\n                else {\n                    const nextFocusOptionIndex = this.flyoutOpen\n                        ? Math.min(this.menuFocusIndex + 1, this.menuElement.optionElements.length - 1)\n                        : 0;\n                    this.setFocusedOption(nextFocusOptionIndex);\n                }\n                return false;\n            }\n            case keyArrowUp: {\n                if (!this.flyoutOpen) {\n                    this.toggleFlyout(true);\n                }\n                else {\n                    const previousFocusOptionIndex = this.flyoutOpen\n                        ? Math.max(this.menuFocusIndex - 1, 0)\n                        : 0;\n                    this.setFocusedOption(previousFocusOptionIndex);\n                }\n                return false;\n            }\n            case keyEscape: {\n                this.toggleFlyout(false);\n                return false;\n            }\n            case keyEnter: {\n                if (this.menuFocusIndex !== -1 &&\n                    this.menuElement.optionElements.length > this.menuFocusIndex) {\n                    this.menuElement.optionElements[this.menuFocusIndex].click();\n                }\n                return false;\n            }\n            case keyArrowRight: {\n                if (document.activeElement !== this.inputElement) {\n                    this.incrementFocusedItem(1);\n                    return false;\n                }\n                // don't block if arrow keys moving caret in input element\n                return true;\n            }\n            case keyArrowLeft: {\n                if (this.inputElement.selectionStart === 0) {\n                    this.incrementFocusedItem(-1);\n                    return false;\n                }\n                // don't block if arrow keys moving caret in input element\n                return true;\n            }\n            case keyDelete:\n            case keyBackspace: {\n                if (document.activeElement === null) {\n                    return true;\n                }\n                if (document.activeElement === this.inputElement) {\n                    if (this.inputElement.selectionStart === 0) {\n                        this.selection = this.selectedItems\n                            .slice(0, this.selectedItems.length - 1)\n                            .toString();\n                        this.toggleFlyout(false);\n                        return false;\n                    }\n                    // let text deletion proceed\n                    return true;\n                }\n                const selectedItems = Array.from(this.listElement.children);\n                const currentFocusedItemIndex = selectedItems.indexOf(document.activeElement);\n                if (currentFocusedItemIndex > -1) {\n                    // delete currently focused item\n                    this.selection = this.selectedItems\n                        .splice(currentFocusedItemIndex, 1)\n                        .toString();\n                    DOM.queueUpdate(() => {\n                        selectedItems[Math.min(selectedItems.length, currentFocusedItemIndex)].focus();\n                    });\n                    return false;\n                }\n                return true;\n            }\n        }\n        this.toggleFlyout(true);\n        return true;\n    }\n    /**\n     * Handle focus in events.\n     */\n    handleFocusIn(e) {\n        return false;\n    }\n    /**\n     * Handle focus out events.\n     */\n    handleFocusOut(e) {\n        if (this.menuElement === undefined ||\n            !this.menuElement.contains(e.relatedTarget)) {\n            this.toggleFlyout(false);\n        }\n        return false;\n    }\n    /**\n     * The list of selected items has changed\n     */\n    handleSelectionChange() {\n        if (this.selectedItems.toString() === this.selection) {\n            return;\n        }\n        this.selectedItems = this.selection === \"\" ? [] : this.selection.split(\",\");\n        this.updateFilteredOptions();\n        DOM.queueUpdate(() => {\n            this.checkMaxItems();\n        });\n        this.$emit(\"selectionchange\", { bubbles: false });\n    }\n    /**\n     * Anchored region is loaded, menu and options exist in the DOM.\n     */\n    handleRegionLoaded(e) {\n        DOM.queueUpdate(() => {\n            this.setFocusedOption(0);\n            this.$emit(\"menuloaded\", { bubbles: false });\n        });\n    }\n    /**\n     * Checks if the maximum number of items has been chosen and updates the ui.\n     */\n    checkMaxItems() {\n        if (this.inputElement === undefined) {\n            return;\n        }\n        if (this.maxSelected !== undefined &&\n            this.selectedItems.length >= this.maxSelected) {\n            if (document.activeElement === this.inputElement) {\n                const selectedItemInstances = Array.from(this.listElement.querySelectorAll(\"[role='listitem']\"));\n                selectedItemInstances[selectedItemInstances.length - 1].focus();\n            }\n            this.inputElement.hidden = true;\n        }\n        else {\n            this.inputElement.hidden = false;\n        }\n    }\n    /**\n     * A list item has been invoked.\n     */\n    handleItemInvoke(e) {\n        if (e.defaultPrevented) {\n            return false;\n        }\n        if (e.target instanceof PickerListItem) {\n            const listItems = Array.from(this.listElement.querySelectorAll(\"[role='listitem']\"));\n            const itemIndex = listItems.indexOf(e.target);\n            if (itemIndex !== -1) {\n                const newSelection = this.selectedItems.slice();\n                newSelection.splice(itemIndex, 1);\n                this.selection = newSelection.toString();\n                DOM.queueUpdate(() => this.incrementFocusedItem(0));\n            }\n            return false;\n        }\n        return true;\n    }\n    /**\n     * A menu option has been invoked.\n     */\n    handleOptionInvoke(e) {\n        if (e.defaultPrevented) {\n            return false;\n        }\n        if (e.target instanceof PickerMenuOption) {\n            if (e.target.value !== undefined) {\n                this.selection = `${this.selection}${this.selection === \"\" ? \"\" : \",\"}${e.target.value}`;\n            }\n            this.inputElement.value = \"\";\n            this.query = \"\";\n            this.inputElement.focus();\n            this.toggleFlyout(false);\n            return false;\n        }\n        // const value: string = (e.target as PickerMenuOption).value;\n        return true;\n    }\n    /**\n     * Increments the focused list item by the specified amount\n     */\n    incrementFocusedItem(increment) {\n        if (this.selectedItems.length === 0) {\n            this.inputElement.focus();\n            return;\n        }\n        const selectedItemsAsElements = Array.from(this.listElement.querySelectorAll(\"[role='listitem']\"));\n        if (document.activeElement !== null) {\n            let currentFocusedItemIndex = selectedItemsAsElements.indexOf(document.activeElement);\n            if (currentFocusedItemIndex === -1) {\n                // use the input element\n                currentFocusedItemIndex = selectedItemsAsElements.length;\n            }\n            const newFocusedItemIndex = Math.min(selectedItemsAsElements.length, Math.max(0, currentFocusedItemIndex + increment));\n            if (newFocusedItemIndex === selectedItemsAsElements.length) {\n                if (this.maxSelected !== undefined &&\n                    this.selectedItems.length >= this.maxSelected) {\n                    selectedItemsAsElements[newFocusedItemIndex - 1].focus();\n                }\n                else {\n                    this.inputElement.focus();\n                }\n            }\n            else {\n                selectedItemsAsElements[newFocusedItemIndex].focus();\n            }\n        }\n    }\n    /**\n     * Disables the menu. Note that the menu can be open, just doens't have any valid options on display.\n     */\n    disableMenu() {\n        var _a, _b, _c;\n        this.menuFocusIndex = -1;\n        this.menuFocusOptionId = undefined;\n        (_a = this.inputElement) === null || _a === void 0 ? void 0 : _a.removeAttribute(\"aria-activedescendant\");\n        (_b = this.inputElement) === null || _b === void 0 ? void 0 : _b.removeAttribute(\"aria-owns\");\n        (_c = this.inputElement) === null || _c === void 0 ? void 0 : _c.removeAttribute(\"aria-expanded\");\n    }\n    /**\n     * Sets the currently focused menu option by index\n     */\n    setFocusedOption(optionIndex) {\n        if (!this.flyoutOpen ||\n            optionIndex === -1 ||\n            this.showNoOptions ||\n            this.showLoading) {\n            this.disableMenu();\n            return;\n        }\n        if (this.menuElement.optionElements.length === 0) {\n            return;\n        }\n        this.menuElement.optionElements.forEach((element) => {\n            element.setAttribute(\"aria-selected\", \"false\");\n        });\n        this.menuFocusIndex = optionIndex;\n        if (this.menuFocusIndex > this.menuElement.optionElements.length - 1) {\n            this.menuFocusIndex = this.menuElement.optionElements.length - 1;\n        }\n        this.menuFocusOptionId = this.menuElement.optionElements[this.menuFocusIndex].id;\n        this.inputElement.setAttribute(\"aria-owns\", this.menuId);\n        this.inputElement.setAttribute(\"aria-expanded\", \"true\");\n        this.inputElement.setAttribute(\"aria-activedescendant\", this.menuFocusOptionId);\n        const focusedOption = this.menuElement.optionElements[this.menuFocusIndex];\n        focusedOption.setAttribute(\"aria-selected\", \"true\");\n        this.menuElement.scrollTo(0, focusedOption.offsetTop);\n    }\n    /**\n     * Updates the template used for the list item repeat behavior\n     */\n    updateListItemTemplate() {\n        var _a;\n        this.activeListItemTemplate =\n            (_a = this.listItemTemplate) !== null && _a !== void 0 ? _a : this.defaultListItemTemplate;\n    }\n    /**\n     * Updates the template used for the menu option repeat behavior\n     */\n    updateOptionTemplate() {\n        var _a;\n        this.activeMenuOptionTemplate =\n            (_a = this.menuOptionTemplate) !== null && _a !== void 0 ? _a : this.defaultMenuOptionTemplate;\n    }\n    /**\n     * Updates the filtered options array\n     */\n    updateFilteredOptions() {\n        this.filteredOptionsList = this.optionsList.slice(0);\n        if (this.filterSelected) {\n            this.filteredOptionsList = this.filteredOptionsList.filter(el => this.selectedItems.indexOf(el) === -1);\n        }\n        if (this.filterQuery && this.query !== \"\" && this.query !== undefined) {\n            this.filteredOptionsList = this.filteredOptionsList.filter(el => el.indexOf(this.query) !== -1);\n        }\n    }\n    /**\n     * Updates the menu configuration\n     */\n    updateMenuConfig() {\n        let newConfig = this.configLookup[this.menuPlacement];\n        if (newConfig === null) {\n            newConfig = FlyoutPosBottomFill;\n        }\n        this.menuConfig = Object.assign(Object.assign({}, newConfig), { autoUpdateMode: \"auto\", fixedPlacement: true, horizontalViewportLock: false, verticalViewportLock: false });\n    }\n}\n__decorate([\n    attr({ attribute: \"selection\" })\n], Picker.prototype, \"selection\", void 0);\n__decorate([\n    attr({ attribute: \"options\" })\n], Picker.prototype, \"options\", void 0);\n__decorate([\n    attr({ attribute: \"filter-selected\", mode: \"boolean\" })\n], Picker.prototype, \"filterSelected\", void 0);\n__decorate([\n    attr({ attribute: \"filter-query\", mode: \"boolean\" })\n], Picker.prototype, \"filterQuery\", void 0);\n__decorate([\n    attr({ attribute: \"max-selected\" })\n], Picker.prototype, \"maxSelected\", void 0);\n__decorate([\n    attr({ attribute: \"no-suggestions-text\" })\n], Picker.prototype, \"noSuggestionsText\", void 0);\n__decorate([\n    attr({ attribute: \"suggestions-available-text\" })\n], Picker.prototype, \"suggestionsAvailableText\", void 0);\n__decorate([\n    attr({ attribute: \"loading-text\" })\n], Picker.prototype, \"loadingText\", void 0);\n__decorate([\n    attr({ attribute: \"label\" })\n], Picker.prototype, \"label\", void 0);\n__decorate([\n    attr({ attribute: \"labelledby\" })\n], Picker.prototype, \"labelledBy\", void 0);\n__decorate([\n    attr({ attribute: \"placeholder\" })\n], Picker.prototype, \"placeholder\", void 0);\n__decorate([\n    attr({ attribute: \"menu-placement\" })\n], Picker.prototype, \"menuPlacement\", void 0);\n__decorate([\n    observable\n], Picker.prototype, \"showLoading\", void 0);\n__decorate([\n    observable\n], Picker.prototype, \"listItemTemplate\", void 0);\n__decorate([\n    observable\n], Picker.prototype, \"defaultListItemTemplate\", void 0);\n__decorate([\n    observable\n], Picker.prototype, \"activeListItemTemplate\", void 0);\n__decorate([\n    observable\n], Picker.prototype, \"menuOptionTemplate\", void 0);\n__decorate([\n    observable\n], Picker.prototype, \"defaultMenuOptionTemplate\", void 0);\n__decorate([\n    observable\n], Picker.prototype, \"activeMenuOptionTemplate\", void 0);\n__decorate([\n    observable\n], Picker.prototype, \"listItemContentsTemplate\", void 0);\n__decorate([\n    observable\n], Picker.prototype, \"menuOptionContentsTemplate\", void 0);\n__decorate([\n    observable\n], Picker.prototype, \"optionsList\", void 0);\n__decorate([\n    observable\n], Picker.prototype, \"query\", void 0);\n__decorate([\n    observable\n], Picker.prototype, \"filteredOptionsList\", void 0);\n__decorate([\n    observable\n], Picker.prototype, \"flyoutOpen\", void 0);\n__decorate([\n    observable\n], Picker.prototype, \"menuId\", void 0);\n__decorate([\n    observable\n], Picker.prototype, \"selectedListTag\", void 0);\n__decorate([\n    observable\n], Picker.prototype, \"menuTag\", void 0);\n__decorate([\n    observable\n], Picker.prototype, \"menuFocusIndex\", void 0);\n__decorate([\n    observable\n], Picker.prototype, \"menuFocusOptionId\", void 0);\n__decorate([\n    observable\n], Picker.prototype, \"showNoOptions\", void 0);\n__decorate([\n    observable\n], Picker.prototype, \"menuConfig\", void 0);\n__decorate([\n    observable\n], Picker.prototype, \"selectedItems\", void 0);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}