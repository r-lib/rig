{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { attr, DOM, nullableNumberConverter, observable } from \"@microsoft/fast-element\";\nimport { inRange, keyArrowDown, keyArrowUp, keyEnd, keyEscape, keyHome, keySpace, keyTab } from \"@microsoft/fast-web-utilities\";\nimport { Listbox } from \"./listbox.js\";\n/**\n * A Listbox Custom HTML Element.\n * Implements the {@link https://w3c.github.io/aria/#listbox | ARIA listbox }.\n *\n * @public\n */\n\nexport class ListboxElement extends Listbox {\n  constructor() {\n    super(...arguments);\n    /**\n     * The index of the most recently checked option.\n     *\n     * @internal\n     * @remarks\n     * Multiple-selection mode only.\n     */\n\n    this.activeIndex = -1;\n    /**\n     * The start index when checking a range of options.\n     *\n     * @internal\n     */\n\n    this.rangeStartIndex = -1;\n  }\n  /**\n   * Returns the last checked option.\n   *\n   * @internal\n   */\n\n\n  get activeOption() {\n    return this.options[this.activeIndex];\n  }\n  /**\n   * Returns the list of checked options.\n   *\n   * @internal\n   */\n\n\n  get checkedOptions() {\n    var _a;\n\n    return (_a = this.options) === null || _a === void 0 ? void 0 : _a.filter(o => o.checked);\n  }\n  /**\n   * Returns the index of the first selected option.\n   *\n   * @internal\n   */\n\n\n  get firstSelectedOptionIndex() {\n    return this.options.indexOf(this.firstSelectedOption);\n  }\n  /**\n   * Updates the `ariaActiveDescendant` property when the active index changes.\n   *\n   * @param prev - the previous active index\n   * @param next - the next active index\n   *\n   * @internal\n   */\n\n\n  activeIndexChanged(prev, next) {\n    var _a, _b;\n\n    this.ariaActiveDescendant = (_b = (_a = this.options[next]) === null || _a === void 0 ? void 0 : _a.id) !== null && _b !== void 0 ? _b : \"\";\n    this.focusAndScrollOptionIntoView();\n  }\n  /**\n   * Toggles the checked state for the currently active option.\n   *\n   * @remarks\n   * Multiple-selection mode only.\n   *\n   * @internal\n   */\n\n\n  checkActiveIndex() {\n    if (!this.multiple) {\n      return;\n    }\n\n    const activeItem = this.activeOption;\n\n    if (activeItem) {\n      activeItem.checked = true;\n    }\n  }\n  /**\n   * Sets the active index to the first option and marks it as checked.\n   *\n   * @remarks\n   * Multi-selection mode only.\n   *\n   * @param preserveChecked - mark all options unchecked before changing the active index\n   *\n   * @internal\n   */\n\n\n  checkFirstOption() {\n    let preserveChecked = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n    if (preserveChecked) {\n      if (this.rangeStartIndex === -1) {\n        this.rangeStartIndex = this.activeIndex + 1;\n      }\n\n      this.options.forEach((o, i) => {\n        o.checked = inRange(i, this.rangeStartIndex);\n      });\n    } else {\n      this.uncheckAllOptions();\n    }\n\n    this.activeIndex = 0;\n    this.checkActiveIndex();\n  }\n  /**\n   * Decrements the active index and sets the matching option as checked.\n   *\n   * @remarks\n   * Multi-selection mode only.\n   *\n   * @param preserveChecked - mark all options unchecked before changing the active index\n   *\n   * @internal\n   */\n\n\n  checkLastOption() {\n    let preserveChecked = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n    if (preserveChecked) {\n      if (this.rangeStartIndex === -1) {\n        this.rangeStartIndex = this.activeIndex;\n      }\n\n      this.options.forEach((o, i) => {\n        o.checked = inRange(i, this.rangeStartIndex, this.options.length);\n      });\n    } else {\n      this.uncheckAllOptions();\n    }\n\n    this.activeIndex = this.options.length - 1;\n    this.checkActiveIndex();\n  }\n  /**\n   * @override\n   * @internal\n   */\n\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.addEventListener(\"focusout\", this.focusoutHandler);\n  }\n  /**\n   * @override\n   * @internal\n   */\n\n\n  disconnectedCallback() {\n    this.removeEventListener(\"focusout\", this.focusoutHandler);\n    super.disconnectedCallback();\n  }\n  /**\n   * Increments the active index and marks the matching option as checked.\n   *\n   * @remarks\n   * Multiple-selection mode only.\n   *\n   * @param preserveChecked - mark all options unchecked before changing the active index\n   *\n   * @internal\n   */\n\n\n  checkNextOption() {\n    let preserveChecked = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n    if (preserveChecked) {\n      if (this.rangeStartIndex === -1) {\n        this.rangeStartIndex = this.activeIndex;\n      }\n\n      this.options.forEach((o, i) => {\n        o.checked = inRange(i, this.rangeStartIndex, this.activeIndex + 1);\n      });\n    } else {\n      this.uncheckAllOptions();\n    }\n\n    this.activeIndex += this.activeIndex < this.options.length - 1 ? 1 : 0;\n    this.checkActiveIndex();\n  }\n  /**\n   * Decrements the active index and marks the matching option as checked.\n   *\n   * @remarks\n   * Multiple-selection mode only.\n   *\n   * @param preserveChecked - mark all options unchecked before changing the active index\n   *\n   * @internal\n   */\n\n\n  checkPreviousOption() {\n    let preserveChecked = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n    if (preserveChecked) {\n      if (this.rangeStartIndex === -1) {\n        this.rangeStartIndex = this.activeIndex;\n      }\n\n      if (this.checkedOptions.length === 1) {\n        this.rangeStartIndex += 1;\n      }\n\n      this.options.forEach((o, i) => {\n        o.checked = inRange(i, this.activeIndex, this.rangeStartIndex);\n      });\n    } else {\n      this.uncheckAllOptions();\n    }\n\n    this.activeIndex -= this.activeIndex > 0 ? 1 : 0;\n    this.checkActiveIndex();\n  }\n  /**\n   * Handles click events for listbox options.\n   *\n   * @param e - the event object\n   *\n   * @override\n   * @internal\n   */\n\n\n  clickHandler(e) {\n    var _a;\n\n    if (!this.multiple) {\n      return super.clickHandler(e);\n    }\n\n    const captured = (_a = e.target) === null || _a === void 0 ? void 0 : _a.closest(`[role=option]`);\n\n    if (!captured || captured.disabled) {\n      return;\n    }\n\n    this.uncheckAllOptions();\n    this.activeIndex = this.options.indexOf(captured);\n    this.checkActiveIndex();\n    this.toggleSelectedForAllCheckedOptions();\n    return true;\n  }\n  /**\n   * @override\n   * @internal\n   */\n\n\n  focusAndScrollOptionIntoView() {\n    super.focusAndScrollOptionIntoView(this.activeOption);\n  }\n  /**\n   * In multiple-selection mode:\n   * If any options are selected, the first selected option is checked when\n   * the listbox receives focus. If no options are selected, the first\n   * selectable option is checked.\n   *\n   * @override\n   * @internal\n   */\n\n\n  focusinHandler(e) {\n    if (!this.multiple) {\n      return super.focusinHandler(e);\n    }\n\n    if (!this.shouldSkipFocus && e.target === e.currentTarget) {\n      this.uncheckAllOptions();\n\n      if (this.activeIndex === -1) {\n        this.activeIndex = this.firstSelectedOptionIndex !== -1 ? this.firstSelectedOptionIndex : 0;\n      }\n\n      this.checkActiveIndex();\n      this.setSelectedOptions();\n      this.focusAndScrollOptionIntoView();\n    }\n\n    this.shouldSkipFocus = false;\n  }\n  /**\n   * Unchecks all options when the listbox loses focus.\n   *\n   * @internal\n   */\n\n\n  focusoutHandler(e) {\n    if (this.multiple) {\n      this.uncheckAllOptions();\n    }\n  }\n  /**\n   * Handles keydown actions for listbox navigation and typeahead\n   *\n   * @override\n   * @internal\n   */\n\n\n  keydownHandler(e) {\n    if (!this.multiple) {\n      return super.keydownHandler(e);\n    }\n\n    if (this.disabled) {\n      return true;\n    }\n\n    const {\n      key,\n      shiftKey\n    } = e;\n    this.shouldSkipFocus = false;\n\n    switch (key) {\n      // Select the first available option\n      case keyHome:\n        {\n          this.checkFirstOption(shiftKey);\n          return;\n        }\n      // Select the next selectable option\n\n      case keyArrowDown:\n        {\n          this.checkNextOption(shiftKey);\n          return;\n        }\n      // Select the previous selectable option\n\n      case keyArrowUp:\n        {\n          this.checkPreviousOption(shiftKey);\n          return;\n        }\n      // Select the last available option\n\n      case keyEnd:\n        {\n          this.checkLastOption(shiftKey);\n          return;\n        }\n\n      case keyTab:\n        {\n          this.focusAndScrollOptionIntoView();\n          return true;\n        }\n\n      case keyEscape:\n        {\n          this.uncheckAllOptions();\n          this.checkActiveIndex();\n          return true;\n        }\n\n      case keySpace:\n        {\n          e.preventDefault();\n\n          if (this.typeAheadExpired) {\n            this.toggleSelectedForAllCheckedOptions();\n            return;\n          }\n        }\n      // Send key to Typeahead handler\n\n      default:\n        {\n          if (key.length === 1) {\n            this.handleTypeAhead(`${key}`);\n          }\n\n          return true;\n        }\n    }\n  }\n  /**\n   * Prevents `focusin` events from firing before `click` events when the\n   * element is unfocused.\n   *\n   * @override\n   * @internal\n   */\n\n\n  mousedownHandler(e) {\n    if (e.offsetX >= 0 && e.offsetX <= this.scrollWidth) {\n      return super.mousedownHandler(e);\n    }\n  }\n  /**\n   * Switches between single-selection and multi-selection mode.\n   *\n   * @internal\n   */\n\n\n  multipleChanged(prev, next) {\n    var _a;\n\n    this.ariaMultiSelectable = next ? \"true\" : null;\n    (_a = this.options) === null || _a === void 0 ? void 0 : _a.forEach(o => {\n      o.checked = next ? false : undefined;\n    });\n    this.setSelectedOptions();\n  }\n  /**\n   * Sets an option as selected and gives it focus.\n   *\n   * @override\n   * @public\n   */\n\n\n  setSelectedOptions() {\n    if (!this.multiple) {\n      super.setSelectedOptions();\n      return;\n    }\n\n    if (this.$fastController.isConnected && this.options) {\n      this.selectedOptions = this.options.filter(o => o.selected);\n      this.focusAndScrollOptionIntoView();\n    }\n  }\n  /**\n   * Ensures the size is a positive integer when the property is updated.\n   *\n   * @param prev - the previous size value\n   * @param next - the current size value\n   *\n   * @internal\n   */\n\n\n  sizeChanged(prev, next) {\n    var _a;\n\n    const size = Math.max(0, parseInt((_a = next === null || next === void 0 ? void 0 : next.toFixed()) !== null && _a !== void 0 ? _a : \"\", 10));\n\n    if (size !== next) {\n      DOM.queueUpdate(() => {\n        this.size = size;\n      });\n    }\n  }\n  /**\n   * Toggles the selected state of the provided options. If any provided items\n   * are in an unselected state, all items are set to selected. If every\n   * provided item is selected, they are all unselected.\n   *\n   * @internal\n   */\n\n\n  toggleSelectedForAllCheckedOptions() {\n    const enabledCheckedOptions = this.checkedOptions.filter(o => !o.disabled);\n    const force = !enabledCheckedOptions.every(o => o.selected);\n    enabledCheckedOptions.forEach(o => o.selected = force);\n    this.selectedIndex = this.options.indexOf(enabledCheckedOptions[enabledCheckedOptions.length - 1]);\n    this.setSelectedOptions();\n  }\n  /**\n   * @override\n   * @internal\n   */\n\n\n  typeaheadBufferChanged(prev, next) {\n    if (!this.multiple) {\n      super.typeaheadBufferChanged(prev, next);\n      return;\n    }\n\n    if (this.$fastController.isConnected) {\n      const typeaheadMatches = this.getTypeaheadMatches();\n      const activeIndex = this.options.indexOf(typeaheadMatches[0]);\n\n      if (activeIndex > -1) {\n        this.activeIndex = activeIndex;\n        this.uncheckAllOptions();\n        this.checkActiveIndex();\n      }\n\n      this.typeAheadExpired = false;\n    }\n  }\n  /**\n   * Unchecks all options.\n   *\n   * @remarks\n   * Multiple-selection mode only.\n   *\n   * @param preserveChecked - reset the rangeStartIndex\n   *\n   * @internal\n   */\n\n\n  uncheckAllOptions() {\n    let preserveChecked = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    this.options.forEach(o => o.checked = this.multiple ? false : undefined);\n\n    if (!preserveChecked) {\n      this.rangeStartIndex = -1;\n    }\n  }\n\n}\n\n__decorate([observable], ListboxElement.prototype, \"activeIndex\", void 0);\n\n__decorate([attr({\n  mode: \"boolean\"\n})], ListboxElement.prototype, \"multiple\", void 0);\n\n__decorate([attr({\n  converter: nullableNumberConverter\n})], ListboxElement.prototype, \"size\", void 0);","map":{"version":3,"names":["__decorate","attr","DOM","nullableNumberConverter","observable","inRange","keyArrowDown","keyArrowUp","keyEnd","keyEscape","keyHome","keySpace","keyTab","Listbox","ListboxElement","constructor","arguments","activeIndex","rangeStartIndex","activeOption","options","checkedOptions","_a","filter","o","checked","firstSelectedOptionIndex","indexOf","firstSelectedOption","activeIndexChanged","prev","next","_b","ariaActiveDescendant","id","focusAndScrollOptionIntoView","checkActiveIndex","multiple","activeItem","checkFirstOption","preserveChecked","forEach","i","uncheckAllOptions","checkLastOption","length","connectedCallback","addEventListener","focusoutHandler","disconnectedCallback","removeEventListener","checkNextOption","checkPreviousOption","clickHandler","e","captured","target","closest","disabled","toggleSelectedForAllCheckedOptions","focusinHandler","shouldSkipFocus","currentTarget","setSelectedOptions","keydownHandler","key","shiftKey","preventDefault","typeAheadExpired","handleTypeAhead","mousedownHandler","offsetX","scrollWidth","multipleChanged","ariaMultiSelectable","undefined","$fastController","isConnected","selectedOptions","selected","sizeChanged","size","Math","max","parseInt","toFixed","queueUpdate","enabledCheckedOptions","force","every","selectedIndex","typeaheadBufferChanged","typeaheadMatches","getTypeaheadMatches","prototype","mode","converter"],"sources":["/Users/gaborcsardi/works/rig/vscode/webview-ui/node_modules/@microsoft/fast-foundation/dist/esm/listbox/listbox.element.js"],"sourcesContent":["import { __decorate } from \"tslib\";\nimport { attr, DOM, nullableNumberConverter, observable } from \"@microsoft/fast-element\";\nimport { inRange, keyArrowDown, keyArrowUp, keyEnd, keyEscape, keyHome, keySpace, keyTab, } from \"@microsoft/fast-web-utilities\";\nimport { Listbox } from \"./listbox.js\";\n/**\n * A Listbox Custom HTML Element.\n * Implements the {@link https://w3c.github.io/aria/#listbox | ARIA listbox }.\n *\n * @public\n */\nexport class ListboxElement extends Listbox {\n    constructor() {\n        super(...arguments);\n        /**\n         * The index of the most recently checked option.\n         *\n         * @internal\n         * @remarks\n         * Multiple-selection mode only.\n         */\n        this.activeIndex = -1;\n        /**\n         * The start index when checking a range of options.\n         *\n         * @internal\n         */\n        this.rangeStartIndex = -1;\n    }\n    /**\n     * Returns the last checked option.\n     *\n     * @internal\n     */\n    get activeOption() {\n        return this.options[this.activeIndex];\n    }\n    /**\n     * Returns the list of checked options.\n     *\n     * @internal\n     */\n    get checkedOptions() {\n        var _a;\n        return (_a = this.options) === null || _a === void 0 ? void 0 : _a.filter(o => o.checked);\n    }\n    /**\n     * Returns the index of the first selected option.\n     *\n     * @internal\n     */\n    get firstSelectedOptionIndex() {\n        return this.options.indexOf(this.firstSelectedOption);\n    }\n    /**\n     * Updates the `ariaActiveDescendant` property when the active index changes.\n     *\n     * @param prev - the previous active index\n     * @param next - the next active index\n     *\n     * @internal\n     */\n    activeIndexChanged(prev, next) {\n        var _a, _b;\n        this.ariaActiveDescendant = (_b = (_a = this.options[next]) === null || _a === void 0 ? void 0 : _a.id) !== null && _b !== void 0 ? _b : \"\";\n        this.focusAndScrollOptionIntoView();\n    }\n    /**\n     * Toggles the checked state for the currently active option.\n     *\n     * @remarks\n     * Multiple-selection mode only.\n     *\n     * @internal\n     */\n    checkActiveIndex() {\n        if (!this.multiple) {\n            return;\n        }\n        const activeItem = this.activeOption;\n        if (activeItem) {\n            activeItem.checked = true;\n        }\n    }\n    /**\n     * Sets the active index to the first option and marks it as checked.\n     *\n     * @remarks\n     * Multi-selection mode only.\n     *\n     * @param preserveChecked - mark all options unchecked before changing the active index\n     *\n     * @internal\n     */\n    checkFirstOption(preserveChecked = false) {\n        if (preserveChecked) {\n            if (this.rangeStartIndex === -1) {\n                this.rangeStartIndex = this.activeIndex + 1;\n            }\n            this.options.forEach((o, i) => {\n                o.checked = inRange(i, this.rangeStartIndex);\n            });\n        }\n        else {\n            this.uncheckAllOptions();\n        }\n        this.activeIndex = 0;\n        this.checkActiveIndex();\n    }\n    /**\n     * Decrements the active index and sets the matching option as checked.\n     *\n     * @remarks\n     * Multi-selection mode only.\n     *\n     * @param preserveChecked - mark all options unchecked before changing the active index\n     *\n     * @internal\n     */\n    checkLastOption(preserveChecked = false) {\n        if (preserveChecked) {\n            if (this.rangeStartIndex === -1) {\n                this.rangeStartIndex = this.activeIndex;\n            }\n            this.options.forEach((o, i) => {\n                o.checked = inRange(i, this.rangeStartIndex, this.options.length);\n            });\n        }\n        else {\n            this.uncheckAllOptions();\n        }\n        this.activeIndex = this.options.length - 1;\n        this.checkActiveIndex();\n    }\n    /**\n     * @override\n     * @internal\n     */\n    connectedCallback() {\n        super.connectedCallback();\n        this.addEventListener(\"focusout\", this.focusoutHandler);\n    }\n    /**\n     * @override\n     * @internal\n     */\n    disconnectedCallback() {\n        this.removeEventListener(\"focusout\", this.focusoutHandler);\n        super.disconnectedCallback();\n    }\n    /**\n     * Increments the active index and marks the matching option as checked.\n     *\n     * @remarks\n     * Multiple-selection mode only.\n     *\n     * @param preserveChecked - mark all options unchecked before changing the active index\n     *\n     * @internal\n     */\n    checkNextOption(preserveChecked = false) {\n        if (preserveChecked) {\n            if (this.rangeStartIndex === -1) {\n                this.rangeStartIndex = this.activeIndex;\n            }\n            this.options.forEach((o, i) => {\n                o.checked = inRange(i, this.rangeStartIndex, this.activeIndex + 1);\n            });\n        }\n        else {\n            this.uncheckAllOptions();\n        }\n        this.activeIndex += this.activeIndex < this.options.length - 1 ? 1 : 0;\n        this.checkActiveIndex();\n    }\n    /**\n     * Decrements the active index and marks the matching option as checked.\n     *\n     * @remarks\n     * Multiple-selection mode only.\n     *\n     * @param preserveChecked - mark all options unchecked before changing the active index\n     *\n     * @internal\n     */\n    checkPreviousOption(preserveChecked = false) {\n        if (preserveChecked) {\n            if (this.rangeStartIndex === -1) {\n                this.rangeStartIndex = this.activeIndex;\n            }\n            if (this.checkedOptions.length === 1) {\n                this.rangeStartIndex += 1;\n            }\n            this.options.forEach((o, i) => {\n                o.checked = inRange(i, this.activeIndex, this.rangeStartIndex);\n            });\n        }\n        else {\n            this.uncheckAllOptions();\n        }\n        this.activeIndex -= this.activeIndex > 0 ? 1 : 0;\n        this.checkActiveIndex();\n    }\n    /**\n     * Handles click events for listbox options.\n     *\n     * @param e - the event object\n     *\n     * @override\n     * @internal\n     */\n    clickHandler(e) {\n        var _a;\n        if (!this.multiple) {\n            return super.clickHandler(e);\n        }\n        const captured = (_a = e.target) === null || _a === void 0 ? void 0 : _a.closest(`[role=option]`);\n        if (!captured || captured.disabled) {\n            return;\n        }\n        this.uncheckAllOptions();\n        this.activeIndex = this.options.indexOf(captured);\n        this.checkActiveIndex();\n        this.toggleSelectedForAllCheckedOptions();\n        return true;\n    }\n    /**\n     * @override\n     * @internal\n     */\n    focusAndScrollOptionIntoView() {\n        super.focusAndScrollOptionIntoView(this.activeOption);\n    }\n    /**\n     * In multiple-selection mode:\n     * If any options are selected, the first selected option is checked when\n     * the listbox receives focus. If no options are selected, the first\n     * selectable option is checked.\n     *\n     * @override\n     * @internal\n     */\n    focusinHandler(e) {\n        if (!this.multiple) {\n            return super.focusinHandler(e);\n        }\n        if (!this.shouldSkipFocus && e.target === e.currentTarget) {\n            this.uncheckAllOptions();\n            if (this.activeIndex === -1) {\n                this.activeIndex =\n                    this.firstSelectedOptionIndex !== -1\n                        ? this.firstSelectedOptionIndex\n                        : 0;\n            }\n            this.checkActiveIndex();\n            this.setSelectedOptions();\n            this.focusAndScrollOptionIntoView();\n        }\n        this.shouldSkipFocus = false;\n    }\n    /**\n     * Unchecks all options when the listbox loses focus.\n     *\n     * @internal\n     */\n    focusoutHandler(e) {\n        if (this.multiple) {\n            this.uncheckAllOptions();\n        }\n    }\n    /**\n     * Handles keydown actions for listbox navigation and typeahead\n     *\n     * @override\n     * @internal\n     */\n    keydownHandler(e) {\n        if (!this.multiple) {\n            return super.keydownHandler(e);\n        }\n        if (this.disabled) {\n            return true;\n        }\n        const { key, shiftKey } = e;\n        this.shouldSkipFocus = false;\n        switch (key) {\n            // Select the first available option\n            case keyHome: {\n                this.checkFirstOption(shiftKey);\n                return;\n            }\n            // Select the next selectable option\n            case keyArrowDown: {\n                this.checkNextOption(shiftKey);\n                return;\n            }\n            // Select the previous selectable option\n            case keyArrowUp: {\n                this.checkPreviousOption(shiftKey);\n                return;\n            }\n            // Select the last available option\n            case keyEnd: {\n                this.checkLastOption(shiftKey);\n                return;\n            }\n            case keyTab: {\n                this.focusAndScrollOptionIntoView();\n                return true;\n            }\n            case keyEscape: {\n                this.uncheckAllOptions();\n                this.checkActiveIndex();\n                return true;\n            }\n            case keySpace: {\n                e.preventDefault();\n                if (this.typeAheadExpired) {\n                    this.toggleSelectedForAllCheckedOptions();\n                    return;\n                }\n            }\n            // Send key to Typeahead handler\n            default: {\n                if (key.length === 1) {\n                    this.handleTypeAhead(`${key}`);\n                }\n                return true;\n            }\n        }\n    }\n    /**\n     * Prevents `focusin` events from firing before `click` events when the\n     * element is unfocused.\n     *\n     * @override\n     * @internal\n     */\n    mousedownHandler(e) {\n        if (e.offsetX >= 0 && e.offsetX <= this.scrollWidth) {\n            return super.mousedownHandler(e);\n        }\n    }\n    /**\n     * Switches between single-selection and multi-selection mode.\n     *\n     * @internal\n     */\n    multipleChanged(prev, next) {\n        var _a;\n        this.ariaMultiSelectable = next ? \"true\" : null;\n        (_a = this.options) === null || _a === void 0 ? void 0 : _a.forEach(o => {\n            o.checked = next ? false : undefined;\n        });\n        this.setSelectedOptions();\n    }\n    /**\n     * Sets an option as selected and gives it focus.\n     *\n     * @override\n     * @public\n     */\n    setSelectedOptions() {\n        if (!this.multiple) {\n            super.setSelectedOptions();\n            return;\n        }\n        if (this.$fastController.isConnected && this.options) {\n            this.selectedOptions = this.options.filter(o => o.selected);\n            this.focusAndScrollOptionIntoView();\n        }\n    }\n    /**\n     * Ensures the size is a positive integer when the property is updated.\n     *\n     * @param prev - the previous size value\n     * @param next - the current size value\n     *\n     * @internal\n     */\n    sizeChanged(prev, next) {\n        var _a;\n        const size = Math.max(0, parseInt((_a = next === null || next === void 0 ? void 0 : next.toFixed()) !== null && _a !== void 0 ? _a : \"\", 10));\n        if (size !== next) {\n            DOM.queueUpdate(() => {\n                this.size = size;\n            });\n        }\n    }\n    /**\n     * Toggles the selected state of the provided options. If any provided items\n     * are in an unselected state, all items are set to selected. If every\n     * provided item is selected, they are all unselected.\n     *\n     * @internal\n     */\n    toggleSelectedForAllCheckedOptions() {\n        const enabledCheckedOptions = this.checkedOptions.filter(o => !o.disabled);\n        const force = !enabledCheckedOptions.every(o => o.selected);\n        enabledCheckedOptions.forEach(o => (o.selected = force));\n        this.selectedIndex = this.options.indexOf(enabledCheckedOptions[enabledCheckedOptions.length - 1]);\n        this.setSelectedOptions();\n    }\n    /**\n     * @override\n     * @internal\n     */\n    typeaheadBufferChanged(prev, next) {\n        if (!this.multiple) {\n            super.typeaheadBufferChanged(prev, next);\n            return;\n        }\n        if (this.$fastController.isConnected) {\n            const typeaheadMatches = this.getTypeaheadMatches();\n            const activeIndex = this.options.indexOf(typeaheadMatches[0]);\n            if (activeIndex > -1) {\n                this.activeIndex = activeIndex;\n                this.uncheckAllOptions();\n                this.checkActiveIndex();\n            }\n            this.typeAheadExpired = false;\n        }\n    }\n    /**\n     * Unchecks all options.\n     *\n     * @remarks\n     * Multiple-selection mode only.\n     *\n     * @param preserveChecked - reset the rangeStartIndex\n     *\n     * @internal\n     */\n    uncheckAllOptions(preserveChecked = false) {\n        this.options.forEach(o => (o.checked = this.multiple ? false : undefined));\n        if (!preserveChecked) {\n            this.rangeStartIndex = -1;\n        }\n    }\n}\n__decorate([\n    observable\n], ListboxElement.prototype, \"activeIndex\", void 0);\n__decorate([\n    attr({ mode: \"boolean\" })\n], ListboxElement.prototype, \"multiple\", void 0);\n__decorate([\n    attr({ converter: nullableNumberConverter })\n], ListboxElement.prototype, \"size\", void 0);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}